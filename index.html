<!-- ==========================
PART 1 / 5 — NAV • HERO • METRICHE • i18n base (FIX)
========================== -->
<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no">

  <title data-i18n="meta.title">Andrea Colucci — Filmmaker | Chiavari & Riviera</title>
  <meta name="description" data-i18n="meta.description" content="Filmmaker per brand, wedding e travel. Video dal look cinematografico e performance social. Chiavari & Riviera di Levante.">
  <link rel="icon" href="/media/logo-mark.svg">
  <link rel="preload" href="/media/hero.webp.jpg" as="image" imagesrcset="/media/hero.webp.jpg 1x" fetchpriority="high">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0f14; --fg:#f5f8ff; --muted:#b7c3d1;
      --glass:rgba(255,255,255,.06); --stroke:rgba(255,255,255,.12);
      --neon1:#2ee7ff; --neon2:#ff3f9c; --accent:#62ffa6;
      --radius:16px; --shadow:0 12px 40px rgba(0,0,0,.35);
      --ring:0 0 0 2px rgba(46,231,255,.18), 0 10px 30px rgba(255,63,156,.18);
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--fg);font-family:'Manrope',system-ui,Segoe UI,Roboto,Arial,sans-serif;overflow-x:hidden}
    img{max-width:100%;display:block}
    a{color:var(--neon1);text-decoration:none}
    a:hover{filter:brightness(1.08)}
    .container{max-width:1200px;margin:0 auto;padding:0 18px}
    .headline{font-family:'Space Grotesk',system-ui,sans-serif;letter-spacing:.4px}
    .h1{font-size: clamp(36px,4.5vw,64px)}
    .h2{font-size: clamp(28px,3vw,44px)}
    .h3{font-size: clamp(20px,2vw,26px)}
    .soft{color:var(--muted)}
    .glass{background:var(--glass);border:1px solid var(--stroke);border-radius:var(--radius);backdrop-filter:blur(8px);box-shadow:var(--shadow)}
    .btn{display:inline-flex;align-items:center;gap:10px;border-radius:999px;padding:10px 14px;border:1px solid var(--stroke);background:var(--glass);backdrop-filter:blur(8px);color:var(--fg);transition:.25s;box-shadow:none;white-space:nowrap}
    .btn:hover{box-shadow:var(--ring)}
    .btn.fill{background:linear-gradient(135deg,var(--neon1),var(--neon2));border-color:transparent;color:#061016}
    .tag{display:inline-flex;align-items:center;gap:10px;padding:8px 12px;border:1px solid var(--stroke);border-radius:999px;background:var(--glass)}
    .grid{display:grid}

    /* ===== NAV compatta + scroller orizzontale ===== */
    .nav{position:sticky;top:0;z-index:60;background:linear-gradient(to right, rgba(11,15,20,.86), rgba(11,15,20,.72));backdrop-filter: blur(8px);border-bottom:1px solid var(--stroke);transition:transform .22s ease}
    .nav-inner{display:grid;grid-template-columns:auto 1fr;align-items:center;gap:10px;padding:8px 12px}
    .brand{display:flex;align-items:center;gap:8px;min-width:0}
    .brand .logo{width:24px;height:24px}
    .brand b{font-weight:800;font-size:15px}
    .brand .soft{font-size:13px;white-space:nowrap;opacity:.9}

    .nav-rail{min-width:0}
    .nav-scroller{
      display:flex;align-items:center;gap:14px;overflow-x:auto;white-space:nowrap;
      -webkit-overflow-scrolling:touch;scrollbar-width:none;padding:4px 2px;
      mask-image: linear-gradient(to right, transparent 0, #000 18px, #000 calc(100% - 18px), transparent 100%);
    }
    .nav-scroller::-webkit-scrollbar{display:none}
    .nav-link{display:inline-block;padding:6px 2px;font-size:14px;color:var(--fg);opacity:.95}
    .nav-link:hover{opacity:1}

    .lang{display:inline-flex;gap:6px;margin-left:4px}
    .lang a{padding:5px 8px;border-radius:999px;border:1px solid var(--stroke);background:rgba(255,255,255,.04);color:#cfe6ff;font-size:12px}
    .lang a.active{background:linear-gradient(135deg,var(--neon1),var(--neon2));color:#061016;border-color:transparent}

    .nav-cta{justify-self:end}
    .nav-cta .btn{font-size:14px;padding:8px 12px}

    @media (max-width:760px){
      .container{padding:0 14px}
      .nav-inner{grid-template-columns:1fr;gap:6px;padding:6px 10px}
      .nav-rail{order:2}
      .nav-cta{order:3;justify-self:start}
      .nav .btn[data-i18n="nav.quote"]{padding:8px 12px;border-radius:18px}
      .nav.nav--hidden{transform: translateY(calc(-100% - 2px))}
      .brand b{font-size:14px}
      .brand .soft{font-size:12px}
    }

    /* ===== HERO ===== */
    .hero{position:relative;overflow:hidden;background:#0b0f14}
    .hero-media{position:absolute;inset:0;z-index:0;pointer-events:none;
      background:linear-gradient(to bottom, rgba(7,10,14,.48), rgba(7,10,14,.66)), url('/media/hero.webp.jpg') center/cover no-repeat;}
    .hero-inner{position:relative;z-index:1;padding:34px 0}
    .hero-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:20px;align-items:center}
    .hero-card{padding:18px;border-radius:18px;background:rgba(255,255,255,.04);border:1px solid var(--stroke);backdrop-filter:blur(8px)}
    .hero-bio{padding:18px;border-radius:18px;border:1px dashed rgba(255,255,255,.18);background:rgba(255,255,255,.03)}
    .hero-bio .row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    .hero-bio img{width:64px;height:64px;border-radius:14px;object-fit:cover;border:1px solid var(--stroke)}

    @media (max-width:980px){.hero-grid{grid-template-columns:1fr}}
    @media (max-width:700px){ .hero{min-height:calc(68vh + env(safe-area-inset-top,0px))} }

    /* ===== METRICHE ===== */
    .metrics{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:10px}
    .metric{padding:12px 12px;text-align:center;word-break:break-word}
    .metric .headline{font-size:clamp(18px,3.6vw,22px)}
    .metric small{display:block;margin-top:4px;line-height:1.25;font-size:clamp(11px,2.9vw,13px)}

    @media (max-width:920px){ .metrics{grid-template-columns:repeat(2,minmax(0,1fr))} }
    @media (max-width:520px){ .metrics{grid-template-columns:1fr} }

    .nowrap{white-space:nowrap}
  </style>

  <!-- ===== Config globale (contatti + recensioni) ===== -->
  <script>
    window.__CONFIG = {
      EMAIL: 'andreacolucci@hotmail.it',
      WA_NUMBER: '393910911719',
      leadText: function(p){
        const packLine = p && p.pack ? ("Pacchetto di interesse: " + p.pack + "\n") : "";
        return (
          "Richiesta preventivo dal sito Andrea Colucci Films\n\n" +
          packLine +
          "Nome: " + (p?.name || '-') + "\n" +
          "Email: " + (p?.email || '-') + "\n" +
          "Telefono/WA: " + (p?.phone || '-') + "\n" +
          "Servizio: " + (p?.service || '-') + "\n\n" +
          (p?.message ? ("Messaggio:\n" + p.message) : "Messaggio:\nVorrei un preventivo e una call veloce per allineamento. Tempistiche: entro 2 settimane. Luogo: da definire.\n") +
          "\n— Inviato dal sito"
        );
      },

      /* =====================
         REVIEWS CONFIG
         ===================== */
     REVIEWS_READ:  'https://script.google.com/macros/s/AKfycbydTGz_v-fpwPkwMSSsOG_Szfw1ZFCU8OBrmcMAUXQDLhqsPubUD5C3n1q4D50cvhBT/exec?action=read&key=acfilms_2025_secretKey_93Jv7',
REVIEWS_WRITE: 'https://script.google.com/macros/s/AKfycbydTGz_v-fpwPkwMSSsOG_Szfw1ZFCU8OBrmcMAUXQDLhqsPubUD5C3n1q4D50cvhBT/exec',
REVIEWS_KEY:   'acfilms_2025_secretKey_93Jv7',


      // 🔧 GVIZ FALLBACK (per NOME TAB: Foglio1)
      REVIEWS_GVIZ:  (function(){
        var id  = '1ix5xllV_Ll1_luifDYmND4DlW0TW1sGhT4Q2Gzbct4g';
        var sheetName = 'Foglio1';
        return 'https://docs.google.com/spreadsheets/d/'+id+'/gviz/tq?sheet='+encodeURIComponent(sheetName)+'&tqx=out:json';
      })(),

      // Mappa colonne dello Sheet (ts,name,role,stars,text,img)
      REVIEWS_MAP: ['ts','name','role','stars','text','img']
    };
  </script>

  <!-- ===== iOS anti-zoom CENTRALIZZATO (ZoomGuard) ===== -->
  <script>
  (function(){
    var isiOS = /iP(hone|ad|od)/.test(navigator.platform) || (navigator.userAgent.includes('Mac') && 'ontouchend' in document);
    if(!isiOS){ window.__ZoomGuard = {enable:function(){}, disable:function(){}, watch:function(){}}; return; }

    var VP_BASE = 'width=device-width, initial-scale=1, viewport-fit=cover';
    function getVP(){
      var vp = document.querySelector('meta[name="viewport"]');
      if(!vp){ vp = document.createElement('meta'); vp.name='viewport'; vp.content=VP_BASE; document.head.appendChild(vp); }
      else {
        var metas = Array.from(document.querySelectorAll('meta[name="viewport"]'));
        for (var i=1;i<metas.length;i++){ metas[i].remove(); }
        vp.setAttribute('content', VP_BASE);
      }
      return vp;
    }
    function setContent(c){ getVP().setAttribute('content', c); }
    function noZoom(){ setContent(VP_BASE + ', maximum-scale=1, user-scalable=no'); }
    function yesZoom(){ setContent(VP_BASE); }

    function ensure17px(el){
      try{
        var fs = parseFloat(getComputedStyle(el).fontSize)||0;
        if(fs < 17){
          el.style.fontSize='17px'; el.style.lineHeight='1.35'; el.style.minHeight='44px';
        }
      }catch(_){}
    }
    function attachTo(container){
      if(!container) return;
      var sel = 'input, select, textarea, button, .control';
      container.querySelectorAll(sel).forEach(function(el){
        ensure17px(el);
        el.addEventListener('focus', function(){ noZoom(); ensure17px(el); }, {passive:true});
        el.addEventListener('blur', function(){ yesZoom(); }, {passive:true});
      });
    }
    var watchedIds = new Set(['contatti','reviewModal']);
    var mo = new MutationObserver(function(){
      watchedIds.forEach(function(id){
        var n = document.getElementById(id);
        if(n && !n.__zgBound){ n.__zgBound = true; attachTo(n); }
      });
    });
    mo.observe(document.documentElement, {childList:true, subtree:true});

    document.addEventListener('focusin', function(e){
      var t = e.target; var inForm = t && t.closest && (t.closest('#contatti') || t.closest('#reviewModal'));
      if(inForm){ noZoom(); ensure17px(t); } else { yesZoom(); }
    }, {passive:true});
    window.addEventListener('gesturestart', yesZoom, {passive:true});

    window.__ZoomGuard = { enable:noZoom, disable:yesZoom, watch:attachTo };
  })();
  </script>

  <!-- ===== Loader recensioni ORCHESTRATO (Backend first, GVIZ fallback) ===== -->
  <script>
  (function(){
    const CFG = window.__CONFIG || {};
    const MAP = (CFG.REVIEWS_MAP || []).slice();

    function toItemsFromGVIZ(text){
      try{
        const start = text.indexOf('('), end = text.lastIndexOf(')');
        if(start === -1 || end === -1) throw new Error('GVIZ format unexpected');
        const json = JSON.parse(text.slice(start+1, end));
        const rows = (json.table && json.table.rows) || [];
        const out = [];
        rows.forEach(r=>{
          if(!r || !r.c) return;
          const obj = {};
          for(let i=0;i<MAP.length;i++){
            const c = r.c[i] && (r.c[i].v != null ? r.c[i].v : r.c[i].f);
            obj[MAP[i]] = c == null ? '' : c;
          }
          if(obj.stars != null){ obj.stars = Number(String(obj.stars).replace(',','.')) || 5; }
          if(obj.ts){ const d = new Date(obj.ts); if(!isNaN(d)) obj.ts = +d; }
          out.push(obj);
        });
        out.sort((a,b)=>(+b.ts||0)-(+a.ts||0));
        return out;
      }catch(e){ console.warn('[reviews] gviz parse fail:', e); return []; }
    }

    async function readFromBackend(){
      try{
        const res = await fetch(CFG.REVIEWS_READ, { cache:'no-store' });
        const j = await res.json();
        if(j && j.ok && Array.isArray(j.items)) return j.items;
      }catch(e){
        console.warn('[reviews] backend read fail:', e);
      }
      return [];
    }

    async function readFromGVIZ(){
      try{
        const res = await fetch(CFG.REVIEWS_GVIZ, { cache:'no-store', redirect:'follow' });
        if(!res.ok) throw new Error('HTTP '+res.status);
        const text = await res.text();
        return toItemsFromGVIZ(text);
      }catch(e){
        console.warn('[reviews] gviz read fail:', e);
        return [];
      }
    }

    async function orchestrate(){
      const a = await readFromBackend();
      if(a.length){
        console.info('[reviews] source: backend count:', a.length);
        return a;
      }
      const b = await readFromGVIZ();
      if(b.length){
        console.info('[reviews] source: gviz fallback count:', b.length);
        return b;
      }
      console.info('[reviews] no data from backend or gviz');
      return [];
    }

    const store = {
      data:[], error:null, ready:null,
      set(a){ this.data = Array.isArray(a) ? a : []; this.error=null; },
      fail(e){ this.error = e || new Error('Unknown'); }
    };
    window.__reviewsStore = store;

    store.ready = orchestrate().then(list=>{
      store.set(list);
      window.dispatchEvent(new CustomEvent('ac:reviews-ready', { detail:{ count:list.length } }));
      return list;
    }).catch(err=>{
      store.fail(err);
      console.error('[ac.reviews] load error:', err);
      return [];
    });
  })();
  </script>

  <!-- ===== i18n BASE ===== -->
  <script>
    (function(){
      window.__i18n = window.__i18n || { __dict:{}, apply:null };
      const base = {
        it:{
          "meta.title":"Andrea Colucci — Filmmaker | Chiavari & Riviera",
          "meta.description":"Filmmaker per brand, wedding e travel. Video dal look cinematografico e performance social. Chiavari & Riviera di Levante.",
          "nav.reel":"Reel","nav.services":"Servizi","nav.packs":"Pacchetti","nav.reviews":"Recensioni","nav.quote":"Richiedi preventivo",
          "hero.badge":"Chiavari · Riviera di Levante",
          "hero.title":"Video che parlano, immagini che restano",
          "hero.subtitle":"Spot commerciali, wedding e brand/travel con look cinematografico e performance social. Drone 4K certificato. Disponibile in Liguria e ovunque serva.",
          "cta.watch":"Guarda il Reel","cta.quote":"Richiedi preventivo",
          "bio.previewTitle":"Andrea Colucci","bio.previewSub":"Filmmaker · Storyteller visivo",
          "bio.previewText":"300+ progetti tra spot, videoclip e branded content. 1.2M+ visualizzazioni su YT e IG. Ritmo, atmosfera e narrativa che rimane.",
          "bio.previewCta":"Scopri i servizi",
          "stats.projects":"Progetti realizzati","stats.views":"Visualizzazioni totali","stats.drone":"Certificato","stats.camera":"Log / Pro codec"
        },
        en:{
          "meta.title":"Andrea Colucci — Filmmaker | Chiavari & Riviera",
          "meta.description":"Filmmaker for brands, weddings and travel. Cinematic look and social performance. Chiavari & Riviera di Levante.",
          "nav.reel":"Reel","nav.services":"Services","nav.packs":"Packages","nav.reviews":"Reviews","nav.quote":"Get a quote",
          "hero.badge":"Chiavari · Riviera di Levante",
          "hero.title":"Videos that speak, images that stay",
          "hero.subtitle":"Commercials, wedding and brand/travel with a cinematic look and social performance. Certified 4K drone. Available in Liguria and wherever needed.",
          "cta.watch":"Watch the Reel","cta.quote":"Request a quote",
          "bio.previewTitle":"Andrea Colucci","bio.previewSub":"Filmmaker · Visual storyteller",
          "bio.previewText":"300+ projects across ads, music and branded content. 1.2M+ views on YT & IG. Rhythm, atmosphere and lasting narrative.",
          "bio.previewCta":"See services",
          "stats.projects":"Projects","stats.views":"Total views","stats.drone":"Certified","stats.camera":"Log / Pro codec"
        },
        es:{
          "meta.title":"Andrea Colucci — Filmmaker | Chiavari & Riviera",
          "meta.description":"Filmmaker para marcas, bodas y travel. Look cinematográfico y rendimiento social. Chiavari y la Riviera de Levante.",
          "nav.reel":"Reel","nav.services":"Servicios","nav.packs":"Paquetes","nav.reviews":"Reseñas","nav.quote":"Pide presupuesto",
          "hero.badge":"Chiavari · Riviera de Levante",
          "hero.title":"Vídeos que hablan, imágenes que perduran",
          "hero.subtitle":"Comerciales, bodas y brand/travel con look cinematográfico y rendimiento social. Dron 4K certificado. Disponible en Liguria y donde haga falta.",
          "cta.watch":"Ver el Reel","cta.quote":"Pedir presupuesto",
          "bio.previewTitle":"Andrea Colucci","bio.previewSub":"Filmmaker · Narrador visual",
          "bio.previewText":"300+ proyectos entre spots, videoclips y branded content. 1.2M+ visualizaciones en YT e IG. Ritmo, atmósfera y narrativa que permanece.",
          "bio.previewCta":"Ver servicios",
          "stats.projects":"Proyectos","stats.views":"Visualizaciones totales","stats.drone":"Certificado","stats.camera":"Log / Códec Pro"
        }
      };

      window.__i18n.apply = function(lang){
        const dict = Object.assign({}, base[lang]||base.it, window.__i18n.__dict?.[lang]||{});
        document.querySelectorAll('[data-i18n]').forEach(el=>{
          const k = el.getAttribute('data-i18n'); const t = dict[k];
          if(!t) return;
          if(el.tagName==='META'){ el.setAttribute('content', t); }
          else el.textContent = t;
        });
        document.title = dict['meta.title'] || document.title;
        document.documentElement.lang = lang;
        document.querySelectorAll('.lang [data-lang]').forEach(a=>{
          const active = (a.getAttribute('data-lang')===lang);
          a.classList.toggle('active', active);
          a.setAttribute('aria-current', active ? 'true' : 'false');
        });
      };

      const urlLang = new URLSearchParams(location.search).get('lang');
      const saved   = localStorage.getItem('ac_lang');
      const start   = urlLang || saved || document.documentElement.lang || 'it';
      window.__i18n.apply(start);

      document.addEventListener('click', (e)=>{
        const a = e.target.closest('.lang [data-lang]'); if(!a) return;
        e.preventDefault();
        const lang=a.getAttribute('data-lang')||'it';
        if(lang === (document.documentElement.lang||'it')) return;
        localStorage.setItem('ac_lang', lang);
        const url=new URL(location.href); url.searchParams.set('lang', lang);
        history.pushState({lang},'',url.toString());
        window.__i18n.apply(lang);
      }, {passive:false});

      window.addEventListener('popstate', ()=>{
        const lang = new URLSearchParams(location.search).get('lang') || 'it';
        window.__i18n.apply(lang);
      });
    })();
  </script>
</head>
<body>

  <!-- ===== NAV compatta con scroller orizzontale ===== -->
  <nav class="nav" aria-label="Main">
    <div class="nav-inner container">
      <a href="#top" class="brand" aria-label="Homepage">
        <img class="logo" src="/media/logo-mark.svg" alt="Logo Andrea Colucci" width="24" height="24">
        <div style="display:flex;gap:6px;align-items:baseline;min-width:0">
          <b>Andrea Colucci</b><span class="soft">/ Filmmaker</span>
        </div>
      </a>

      <div class="nav-rail">
        <div class="nav-scroller">
          <!-- Ordine richiesto: Servizi, Pacchetti, Recensioni, Reel -->
          <a class="nav-link" href="#servizi" data-i18n="nav.services">Servizi</a>
          <a class="nav-link" href="#pacchetti-videoprofessionali" data-i18n="nav.packs">Pacchetti</a>
          <a class="nav-link" href="#recensioni" data-i18n="nav.reviews">Recensioni</a>
          <a class="nav-link" href="#reel" data-i18n="nav.reel">Reel</a>
          <!-- Lingue dentro lo scroller -->
          <span class="lang" aria-label="Lingua">
            <a href="?lang=it" data-lang="it" class="active" aria-current="true">IT</a>
            <a href="?lang=en" data-lang="en" aria-current="false">EN</a>
            <a href="?lang=es" data-lang="es" aria-current="false">ES</a>
          </span>
        </div>
      </div>

      <div class="nav-cta">
        <a href="#contatti" class="btn" data-i18n="nav.quote">Richiedi preventivo</a>
      </div>
    </div>
  </nav>

  <!-- ===== HERO ===== -->
  <header class="hero" id="top">
    <div class="hero-media" aria-hidden="true"></div>
    <div class="hero-inner container">
      <div class="hero-grid">
        <section class="hero-card">
          <span class="tag headline" data-i18n="hero.badge">Chiavari · Riviera di Levante</span>
          <h1 class="headline h1" data-i18n="hero.title">Video che parlano, immagini che restano</h1>
          <p class="soft" data-i18n="hero.subtitle">
            Spot commerciali, wedding e brand/travel con look cinematografico e performance social.
            Drone 4K certificato. Disponibile in Liguria e ovunque serva.
          </p>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:6px">
            <a href="#reel" class="btn fill" data-i18n="cta.watch">Guarda il Reel</a>
            <a href="#contatti" class="btn" data-i18n="cta.quote">Richiedi preventivo</a>
          </div>
        </section>

        <aside class="hero-bio glass">
          <div class="row">
            <img src="/media/about-2.jpg" alt="Andrea Colucci e team" loading="lazy" decoding="async"/>
            <div>
              <div class="headline h3" data-i18n="bio.previewTitle">Andrea Colucci</div>
              <small class="soft" data-i18n="bio.previewSub">Filmmaker · Storyteller visivo</small>
            </div>
          </div>
          <p style="margin-top:10px" class="soft" data-i18n="bio.previewText">
            300+ progetti tra spot, videoclip e branded content. 1.2M+ visualizzazioni su YT e IG.
            Ritmo, atmosfera e narrativa che rimane.
          </p>
          <a href="#servizi" class="btn" data-i18n="bio.previewCta">Scopri i servizi</a>
        </aside>
      </div>
    </div>
  </header>

  <!-- ===== METRICHE (senza overflow) ===== -->
  <section class="container" style="padding:18px 0 6px">
    <div class="metrics">
      <div class="glass metric">
        <div class="headline" style="margin:0">300+</div>
        <small class="soft" data-i18n="stats.projects">Progetti realizzati</small>
      </div>
      <div class="glass metric">
        <div class="headline" style="margin:0">1.2M+</div>
        <small class="soft" data-i18n="stats.views">Visualizzazioni totali</small>
      </div>
      <div class="glass metric">
        <div class="headline" style="margin:0">Drone</div>
        <small class="soft" data-i18n="stats.drone">Certificato</small>
      </div>
      <div class="glass metric">
        <div class="headline" style="margin:0">4K · 10-bit</div>
        <small class="soft" data-i18n="stats.camera">Log / Pro codec</small>
      </div>
    </div>
  </section>

  <!-- Segnaposto #contatti per ancoraggio CTA -->
  <section id="contatti-anchor" style="padding:1px 0"></section>

  <!-- ===== CTA universale → #contatti ===== -->
  <script>
    (function(){
      function toContacts(e){
        var t = document.querySelector('#contatti'); if(!t) return;
        e && e.preventDefault && e.preventDefault();
        var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        t.scrollIntoView({behavior: prefersReduced ? 'auto' : 'smooth', block:'start'});
      }
      document.addEventListener('click', function(e){
        var a = e.target.closest('a'); if(!a) return;
        var href = a.getAttribute('href')||'';
        if(href === '#contatti'){ toContacts(e); return; }
        var txt = (a.textContent||'').trim().toLowerCase();
        var dict = ['richiedi preventivo','parliamone ora','get a quote',"let's talk",'pide presupuesto','hablemos','preventivo'];
        if(dict.includes(txt)){ a.setAttribute('href','#contatti'); toContacts(e); }
      }, {passive:false});
    })();
  </script>

  <!-- ===== NAV MOBILE: hide/show on scroll up ===== -->
  <script>
    (function(){
      var nav = document.querySelector('.nav'); if(!nav) return;
      var lastY = window.scrollY || 0, ticking = false;

      function onScroll(){
        if(ticking) return; ticking = true;
        requestAnimationFrame(function(){
          if(window.innerWidth > 760){
            nav.style.transform = ''; lastY = window.scrollY || 0; ticking=false; return;
          }
          var y = window.scrollY || 0;
          var goingDown = (y > lastY + 6);
          var goingUp   = (y < lastY - 6);
          if(goingDown && y > 60){ nav.classList.add('nav--hidden'); }
          else if(goingUp || y < 10){ nav.classList.remove('nav--hidden'); }
          lastY = y; ticking=false;
        });
      }
      window.addEventListener('scroll', onScroll, {passive:true});
      window.addEventListener('resize', function(){ if(window.innerWidth > 760) nav.classList.remove('nav--hidden'); }, {passive:true});
    })();
  </script>

</body>
</html>
<!-- FINE PARTE 1 / 5 (FIX) -->


<!-- ==========================
PART 2 / 5 — SERVIZI • REEL (FIX)
(look identico; paging stabile; Vimeo autoplay muted + pausa/play con IntersectionObserver e visibility)
========================== -->

<!-- ====== SERVIZI (6 card) ====== -->
<section id="servizi" class="container"
         style="padding:28px 0 8px;
                background-image:
                  linear-gradient(to bottom, rgba(10,10,10,.85), rgba(10,10,10,.70)),
                  url('/media/bg-services.webp.jpg');
                background-size:cover;background-position:center;background-repeat:no-repeat">
  <header style="display:flex;align-items:flex-end;justify-content:space-between;gap:14px;margin-bottom:14px">
    <h2 class="headline h2" style="margin:0" data-i18n="services.title">Servizi principali</h2>
    <a href="#contatti" class="btn" data-i18n="services.cta">Richiedi preventivo</a>
  </header>

  <div class="grid grid-3" style="gap:14px">
    <!-- Brand/Commercial -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,var(--neon1),var(--neon2));box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Brand">
          <path d="M4 6h16v12H4z" opacity=".2"/>
          <path d="M4 6h16M4 18h16M9 6v12" stroke="#061016" stroke-width="2"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.brand.title">Brand & Commercial</h3>
        <p class="soft" style="margin:0" data-i18n="services.brand.desc">Spot per aziende, hotel e location; script, riprese multi-camera, color grading e consegne ottimizzate per social/ADV.</p>
      </div>
    </article>

    <!-- Wedding -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,#ffd6e8,var(--neon2));box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" aria-label="Wedding">
          <path d="M12 7l3 3-3 3-3-3 3-3z" opacity=".2"/>
          <path d="M6 18a6 6 0 0112 0H6zM9 7l3-3 3 3" stroke="#061016" stroke-width="2" fill="none"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.wedding.title">Wedding Film</h3>
        <p class="soft" style="margin:0" data-i18n="services.wedding.desc">Stile cinematografico, audio curato e storytelling emotivo. Trailer + film lungo, opzione drone dove consentito.</p>
      </div>
    </article>

    <!-- Travel/Real Estate -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,var(--neon1),#a0ffd4);box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" aria-label="Travel">
          <path d="M3 12h18M12 3v18" stroke="#061016" stroke-width="2"/>
          <circle cx="12" cy="12" r="3" opacity=".2"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.travel.title">Travel & Real Estate</h3>
        <p class="soft" style="margin:0" data-i18n="services.travel.desc">Contenuti per turismo, barche, proprietà: riprese aeree, motion dinamico, consegne verticali (Reels/Shorts).</p>
      </div>
    </article>

    <!-- Music Video -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,#fff0b3,#ffd84d);box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" aria-label="Music Video">
          <path d="M9 18a3 3 0 100-6 3 3 0 000 6zm6-11v8" stroke="#061016" stroke-width="2" fill="none"/>
          <path d="M15 7l5-1v7" stroke="#061016" stroke-width="2" fill="none"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.music.title">Music Video</h3>
        <p class="soft" style="margin:0" data-i18n="services.music.desc">Regia, storyboard e riprese multi-camera; clip verticali extra per lanciare il singolo.</p>
      </div>
    </article>

    <!-- Eventi & Corporate -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,#a0ffd4,#62ffa6);box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" aria-label="Eventi">
          <path d="M4 7h16v12H4zM8 3v4M16 3v4" stroke="#061016" stroke-width="2" fill="none"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.events.title">Eventi & Corporate</h3>
        <p class="soft" style="margin:0" data-i18n="services.events.desc">Conferenze, lanci prodotto, aftermovie; highlights + cut social in 24/48h.</p>
      </div>
    </article>

    <!-- Boat / Charter -->
    <article class="glass" style="padding:18px;display:grid;grid-template-columns:68px 1fr;gap:14px;align-items:center">
      <div aria-hidden="true" style="width:68px;height:68px;border-radius:14px;background:linear-gradient(135deg,var(--neon1),#6fe2ff);box-shadow:var(--ring);display:grid;place-items:center">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#061016" xmlns="http://www.w3.org/2000/svg" aria-label="Boat">
          <path d="M3 15l9 4 9-4-9-9-9 9z" opacity=".2"/>
          <path d="M3 15l9 4 9-4M12 19v-9" stroke="#061016" stroke-width="2" fill="none"/>
        </svg>
      </div>
      <div>
        <h3 class="headline h3" style="margin:0 0 4px" data-i18n="services.boat.title">Boat / Charter</h3>
        <p class="soft" style="margin:0" data-i18n="services.boat.desc">Esperienza a bordo: riprese aeree, cabina, navigazione; pacchetti stagionali per flotte.</p>
      </div>
    </article>
  </div>
</section>

<!-- ====== REEL (con paging, 6 desktop / 3 mobile) ====== -->
<section id="reel" class="container"
         style="padding:24px 0 8px;
                background-image:
                  linear-gradient(to bottom, rgba(10,10,10,.85), rgba(10,10,10,.70)),
                  url('/media/bg-portfolio.webp.jpg');
                background-size:cover;background-position:center;background-repeat:no-repeat">
  <header style="display:flex;align-items:flex-end;justify-content:space-between;gap:14px;margin-bottom:10px">
    <h2 class="headline h2" style="margin:0" data-i18n="reel.title">Reel selezionati</h2>
    <div class="reel-nav" style="display:flex;gap:8px;align-items:center">
      <button class="btn" id="reelPrev" aria-label="Pagina precedente">‹</button>
      <span class="soft" id="reelCounter" style="min-width:70px;text-align:center">1/1</span>
      <button class="btn" id="reelNext" aria-label="Pagina successiva">›</button>
    </div>
  </header>

  <div id="reelGrid" class="grid" style="gap:12px"></div>
</section>

<!-- ====== STILI SPECIFICI ====== -->
<style>
  :root{ --videoTitleColor: var(--neon1); }

  .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1100px){ .grid-3{grid-template-columns:repeat(2,minmax(0,1fr))} }
  @media (max-width:680px){ .grid-3{grid-template-columns:1fr} }

  .videocard{ border-radius:16px; overflow:hidden; background:rgba(255,255,255,.03); }
  .videocard .frame{ position:relative;width:100%;padding-top:56.25%; background:#000; }
  .videocard .frame iframe{
    position:absolute;inset:0;width:100%;height:100%;border:0;display:block;
    filter:brightness(1.18) contrast(1.12) saturate(1.06); transition:filter .25s ease;
  }
  .videocard:hover .frame iframe{ filter:brightness(1.32) contrast(1.16) saturate(1.10); }

  .videocard .meta{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    padding:10px 12px;border-top:1px solid var(--stroke); background:rgba(255,255,255,.03);
  }
  .videocard .vid-title{ color:var(--videoTitleColor); font-weight:700; letter-spacing:.2px; margin:0; }
  .videocard .vid-len{ color:#c9c9c9; }

  #reelGrid{ display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); }
  @media (max-width:680px){ #reelGrid{ grid-template-columns:1fr; } }

  .reel-nav .btn{min-width:40px;padding:6px 10px}
</style>

<!-- ====== SCRIPT: Dataset, Render, Paging, Vimeo PostMessage ====== -->
<script>
(function(){
  // === DATASET (puoi cambiare/ordinare i video qui) ===
  var VIDEOS = [
    {url:"https://player.vimeo.com/video/1041605119", title:"Travel — Alto-Adige Emotions", len:"1:20"},
    {url:"https://player.vimeo.com/video/967274150", title:"Promo — CharterBoat Lavagna", len:"90s"},
    {url:"https://player.vimeo.com/video/1129572868", title:"Showreels 2025", len:"1:18"},
    {url:"https://player.vimeo.com/video/1080060195", title:"ShoesSpot - E-Commerce", len:"1:05"},
    {url:"https://player.vimeo.com/video/1025024490", title:"Wedding — Real Emotions", len:"3:10"},
    {url:"https://player.vimeo.com/video/988374113", title:"CosmeticSpot — Energy", len:"60s"},
    {url:"https://player.vimeo.com/video/967514987", title:"Vivi la Toscana — Movement", len:"0:55"},
    {url:"https://player.vimeo.com/video/988376023", title:"Wedding — Erica e Bobbi", len:"2:30"},
  {url:"https://player.vimeo.com/video/1126236893", title:"EdiliziaLigure — Spot", len:"1:10"},
  {url:"https://player.vimeo.com/video/1126627619", title:"Luxury Drone — Adeje Sunset", len:"1:25"},
  {url:"https://player.vimeo.com/video/1108038764", title:"Covo di NordEst — Ocean View", len:"2:15"},
  {url:"https://player.vimeo.com/video/1107930426", title:"FoodSpot — ZenzeroFusion", len:"1:30"},
  {url:"https://player.vimeo.com/video/1096075835", title:"TattoSpot — Magma Tattoo", len:"1:00"},
  {url:"https://player.vimeo.com/video/1033671713", title:"Music Video — Macca-Aurora Boreale", len:"1:20"},
  {url:"https://player.vimeo.com/video/1096076952", title:"Charter Boat Spot — Blu Noleggio", len:"1:10"},
  {url:"https://player.vimeo.com/video/1069960325", title:"Motocross Spot — Mostra i tuoi accessori!", len:"1:40"},
    {url:"https://player.vimeo.com/video/1077604297", title:"Brand — Motion", len:"75s"},
];

  // Parametri Vimeo; evitiamo allowfullscreen duplicato (niente warning)
  function vimeoSrc(base){
    var q = [
      "quality=1080p","autoplay=1","muted=1","loop=1","autopause=0",
      "controls=0","title=0","byline=0","portrait=0","pip=0","playsinline=1"
    ].join("&");
    return base + "?" + q;
  }

  var grid   = document.getElementById('reelGrid');
  var prevB  = document.getElementById('reelPrev');
  var nextB  = document.getElementById('reelNext');
  var count  = document.getElementById('reelCounter');

  var state = { page:1, perPage: perPageForViewport(), total: 1 };

  function perPageForViewport(){
    return (window.matchMedia && window.matchMedia("(max-width:680px)").matches) ? 3 : 6;
  }

  function updatePager(){
    var max = Math.max(1, Math.ceil(VIDEOS.length / state.perPage));
    state.total = max;
    if(count) count.textContent = state.page + "/" + max;
    if(prevB) prevB.disabled = (state.page<=1);
    if(nextB) nextB.disabled = (state.page>=max);
  }

  function clearGrid(){
    while(grid && grid.firstChild) grid.removeChild(grid.firstChild);
  }

  function renderPage(){
    if(!grid) return;
    clearGrid();
    var start = (state.page-1)*state.perPage;
    var slice = VIDEOS.slice(start, start+state.perPage);

    slice.forEach(function(v){
      var card = document.createElement('article');
      card.className = 'videocard';

      var frame = document.createElement('div');
      frame.className = 'frame';

      var ifr = document.createElement('iframe');
      ifr.loading = 'lazy';
      ifr.setAttribute('allow', 'autoplay; fullscreen; picture-in-picture');
      // evitiamo l’attributo allowfullscreen perché è deprecato rispetto a "allow"
      ifr.title = v.title + " — Vimeo player";
      ifr.src = vimeoSrc(v.url);
      frame.appendChild(ifr);

      var meta = document.createElement('div');
      meta.className = 'meta';
      var t = document.createElement('b');
      t.className = 'vid-title';
      t.textContent = v.title;
      var len = document.createElement('span');
      len.className = 'vid-len soft';
      len.textContent = v.len;

      meta.appendChild(t); meta.appendChild(len);
      card.appendChild(frame); card.appendChild(meta);
      grid.appendChild(card);
    });

    setupIntersection();
    postAll(document.hidden ? 'pause' : 'play');
    updatePager();
    // mantieni la testata del reel a vista quando cambi pagina
  }

  function goto(delta){
  var max = Math.max(1, Math.ceil(VIDEOS.length / state.perPage));
  state.page = Math.min(max, Math.max(1, state.page + delta));
  renderPage();

  // Scroll SOLO quando sfogli le pagine del Reel
  try{
    document.getElementById('reel').querySelector('h2').scrollIntoView({block:'nearest'});
  }catch(_){}
}


  if(prevB) prevB.addEventListener('click', function(){ goto(-1); });
  if(nextB) nextB.addEventListener('click', function(){ goto(+1); });

  var mq = window.matchMedia ? window.matchMedia("(max-width:680px)") : null;
  if(mq){
    mq.addEventListener('change', function(){
      var old = state.perPage;
      state.perPage = perPageForViewport();
      if(state.perPage !== old){ state.page = 1; renderPage(); }
    });
  }
  window.addEventListener('resize', function(){
    var p = perPageForViewport();
    if(p !== state.perPage){ state.perPage = p; state.page = 1; renderPage(); }
  });

  // === Vimeo PostMessage helpers ===
  function postAll(method){
    document.querySelectorAll('#reel iframe').forEach(function(fr){
      try{ fr.contentWindow && fr.contentWindow.postMessage({method:method}, '*'); }catch(e){}
    });
  }
  document.addEventListener('visibilitychange', function(){
    postAll(document.hidden ? 'pause' : 'play');
  });

  var io;
  function setupIntersection(){
    if(io) { io.disconnect(); io = null; }
    var frames = Array.prototype.slice.call(document.querySelectorAll('#reel iframe'));
    if('IntersectionObserver' in window && frames.length){
      io = new IntersectionObserver(function(entries){
        entries.forEach(function(en){
          try{
            var m = en.isIntersecting ? 'play' : 'pause';
            en.target.contentWindow && en.target.contentWindow.postMessage({method:m}, '*');
          }catch(e){}
        });
      }, {root:null, rootMargin:'0px', threshold:0.4});
      frames.forEach(function(fr){ io.observe(fr); });
    }
  }

  // CTA smooth scroll da Servizi
  document.querySelectorAll('#servizi a[href="#contatti"]').forEach(function(a){
    a.addEventListener('click', function(e){
      var t = document.querySelector('#contatti'); if(!t) return;
      e.preventDefault();
      var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      t.scrollIntoView({behavior: prefersReduced ? 'auto' : 'smooth', block:'start'});
    }, {passive:false});
  });

  // Init
  renderPage();
})();
</script>



<!-- ==========================
PART 3 / 5 — PACCHETTI • CTA • BIO (FIX)
(prefill pack → #contatti, WA con pack, prezzi +IVA, 3a foto solo mobile)
========================== -->

<!-- ====== PACCHETTI VIDEO COMMERCIALI ====== -->
<section id="pacchetti-videoprofessionali" class="container"
         style="padding:28px 0 12px;
                background-image:
                  linear-gradient(to bottom, rgba(10,10,10,.88), rgba(10,10,10,.72)),
                  url('/media/bg-pricing.webp.jpg');
                background-size:cover;background-position:center;background-repeat:no-repeat">
  <header style="display:flex;align-items:flex-end;justify-content:space-between;gap:14px;margin-bottom:14px">
    <h2 class="headline h2" style="margin:0" data-i18n="packs.title">Pacchetti Video Commerciali</h2>
    <a href="#contatti" class="btn" data-i18n="packs.cta">Richiedi preventivo</a>
  </header>

  <!-- 3 pacchetti principali -->
  <div class="grid grid-3" style="gap:12px;margin-bottom:12px">
    <!-- Basic -->
    <article class="glass pack-card" data-pack="Basic" style="overflow:hidden">
      <div style="position:relative">
        <img src="/media/portfolio-1.jpg" alt="Basic" loading="lazy"
             style="width:100%;height:150px;object-fit:cover;display:block;filter:brightness(.8) contrast(1.06)">
        <div style="position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), rgba(0,0,0,.15) 55%, rgba(0,0,0,0))"></div>
        <div style="position:absolute;left:12px;right:12px;bottom:10px">
          <h3 class="headline h3" style="margin:0 0 4px" data-i18n="packs.basic.title">Basic</h3>
          <p class="soft" style="margin:0 0 8px" data-i18n="packs.basic.desc">Video breve (&lt;1 min), riprese e montaggio base.</p>
          <div class="price"><span data-i18n="packs.basic.price">€399</span> <small class="soft" data-i18n="packs.vat">+ IVA</small></div>
        </div>
      </div>
      <ul class="soft" style="margin:8px 12px 12px; padding-left:18px">
        <li>Mezza giornata di riprese</li>
        <li>1 consegna orizzontale + 1 verticale</li>
        <li>Color base</li>
      </ul>
      <div style="padding:0 12px 12px;display:flex;justify-content:flex-end">
        <a href="#contatti" class="btn" data-i18n="packs.select">Seleziona</a>
      </div>
    </article>

    <!-- Standard (Consigliato) -->
    <article class="glass pack-card" data-pack="Standard" style="overflow:hidden;box-shadow:var(--ring)">
      <div style="position:relative">
        <img src="/media/bg-realestate.webp.jpg" alt="Standard" loading="lazy"
             style="width:100%;height:150px;object-fit:cover;display:block;filter:brightness(.82) contrast(1.08)">
        <div style="position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), rgba(0,0,0,.15) 55%, rgba(0,0,0,0))"></div>
        <div style="position:absolute;left:12px;right:12px;bottom:10px;display:flex;align-items:center;justify-content:space-between;gap:10px">
          <div>
            <h3 class="headline h3" style="margin:0 0 4px" data-i18n="packs.standard.title">Standard</h3>
            <p class="soft" style="margin:0 0 8px" data-i18n="packs.standard.desc">Promo (&lt;3 min), montaggio avanzato e color grading.</p>
            <div class="price"><span data-i18n="packs.standard.price">€599</span> <small class="soft" data-i18n="packs.vat">+ IVA</small></div>
          </div>
          <span class="tag" aria-label="Consigliato" data-i18n="packs.recommended">Consigliato</span>
        </div>
      </div>
      <ul class="soft" style="margin:8px 12px 12px; padding-left:18px">
        <li>1 giornata di riprese</li>
        <li>2 consegne verticali + 1 orizzontale</li>
        <li>Color grading + sound design</li>
      </ul>
      <div style="padding:0 12px 12px;display:flex;justify-content:flex-end">
        <a href="#contatti" class="btn fill" data-i18n="packs.select">Seleziona</a>
      </div>
    </article>

    <!-- Premium -->
    <article class="glass pack-card" data-pack="Premium" style="overflow:hidden">
      <div style="position:relative">
        <img src="/media/bg-turismo.webp.jpg" alt="Premium" loading="lazy"
             style="width:100%;height:150px;object-fit:cover;display:block;filter:brightness(.82) contrast(1.08)">
        <div style="position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), rgba(0,0,0,.15) 55%, rgba(0,0,0,0))"></div>
        <div style="position:absolute;left:12px;right:12px;bottom:10px">
          <h3 class="headline h3" style="margin:0 0 4px" data-i18n="packs.premium.title">Premium</h3>
          <p class="soft" style="margin:0 0 8px" data-i18n="packs.premium.desc">Cinematografico (&gt;3 min), storytelling + drone.</p>
          <div class="price"><span data-i18n="packs.premium.price">€999</span> <small class="soft" data-i18n="packs.vat">+ IVA</small></div>
        </div>
      </div>
      <ul class="soft" style="margin:8px 12px 12px; padding-left:18px">
        <li>1–2 giorni di riprese</li>
        <li>Drone (dove consentito)</li>
        <li>Consegne verticali continuo</li>
      </ul>
      <div style="padding:0 12px 12px;display:flex;justify-content:flex-end">
        <a href="#contatti" class="btn" data-i18n="packs.select">Seleziona</a>
      </div>
    </article>
  </div>

  <!-- 2 pacchetti avanzati -->
  <div class="grid grid-2" style="gap:12px">
    <!-- Elite Project -->
    <article class="glass pack-card" data-pack="Elite Project" style="overflow:hidden">
      <div style="position:relative">
        <img src="/media/bg-portfolio.webp.jpg" alt="Elite Project" loading="lazy"
             style="width:100%;height:140px;object-fit:cover;display:block;filter:brightness(.8) contrast(1.06)">
        <div style="position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), rgba(0,0,0,.15) 55%, rgba(0,0,0,0))"></div>
        <div style="position:absolute;left:12px;right:12px;bottom:10px">
          <h3 class="headline h3" style="margin:0 0 4px" data-i18n="packs.elite.title">Elite Project</h3>
          <p class="soft" style="margin:0 0 8px" data-i18n="packs.elite.desc">Produzione multi-giorno, multi-location, regia.</p>
          <div class="price"><span data-i18n="packs.elite.price">€1.999</span> <small class="soft" data-i18n="packs.vat">+ IVA</small></div>
        </div>
      </div>
      <ul class="soft" style="margin:8px 12px 12px; padding-left:18px">
        <li>Team esteso + regia</li>
        <li>Storyboard & pre-produzione</li>
        <li>Consegne multi-piattaforma</li>
      </ul>
      <div style="padding:0 12px 12px;display:flex;justify-content:flex-end">
        <a href="#contatti" class="btn" data-i18n="packs.select">Seleziona</a>
      </div>
    </article>

    <!-- Full Storytelling -->
    <article class="glass pack-card" data-pack="Full Storytelling" style="overflow:hidden">
      <div style="position:relative">
        <img src="/media/bg-charter.webp.jpg" alt="Full Storytelling" loading="lazy"
             style="width:100%;height:140px;object-fit:cover;display:block;filter:brightness(.8) contrast(1.06)">
        <div style="position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.7), rgba(0,0,0,.15) 55%, rgba(0,0,0,0))"></div>
        <div style="position:absolute;left:12px;right:12px;bottom:10px">
          <h3 class="headline h3" style="margin:0 0 4px" data-i18n="packs.fullstory.title">Full Storytelling</h3>
          <p class="soft" style="margin:0 0 8px" data-i18n="packs.fullstory.desc">Piano completo: main video + short form continuativa.</p>
          <div class="price"><span data-i18n="packs.fullstory.price">€3.500</span> <small class="soft" data-i18n="packs.vat">+ IVA</small></div>
        </div>
      </div>
      <ul class="soft" style="margin:8px 12px 12px; padding-left:18px">
        <li>Piano editoriale trimestrale</li>
        <li>Batch di Reels/Shorts</li>
        <li>Reportistica risultati</li>
      </ul>
      <div style="padding:0 12px 12px;display:flex;justify-content:flex-end">
        <a href="#contatti" class="btn" data-i18n="packs.select">Seleziona</a>
      </div>
    </article>
  </div>

  <style>
    .pack-card{transition:transform .25s ease, box-shadow .25s ease}
    .pack-card:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,.3), var(--ring)}
    .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:1100px){
      .grid-3{grid-template-columns:repeat(2,minmax(0,1fr))}
    }
    @media (max-width:700px){
      .grid-3, .grid-2{grid-template-columns:1fr}
    }
  </style>
</section>

<!-- ====== CTA COMPATTA ====== -->
<section id="cta" class="container" style="padding:20px 0 6px">
  <div class="glass" style="display:flex;gap:10px;align-items:center;justify-content:space-between;padding:14px 16px">
    <div style="display:flex;flex-wrap:wrap;gap:10px;align-items:center">
      <span class="headline h3" style="margin:0" data-i18n="cta.headline">Pronto a dare vita al tuo progetto?</span>
      <span class="soft" data-i18n="cta.sub">Risposta in giornata, brief gratuito.</span>
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <a href="#contatti" class="btn fill" data-i18n="cta.quote">Richiedi preventivo</a>
      <a class="btn" id="ctaWhatsApp" rel="noopener" target="_blank" data-i18n="cta.whatsapp">Scrivimi su WhatsApp</a>
    </div>
  </div>
</section>

<!-- ====== BIO (sfondo NON scurito) ====== -->
<section id="bio" class="container" style="padding:26px 0 8px;position:relative">
  <div class="bio-wrap glass" style="display:grid;grid-template-columns:1.1fr .9fr;gap:16px;align-items:center;overflow:hidden">
    <!-- Testo -->
    <div style="padding:18px">
      <div class="tag" style="margin-bottom:8px"><span data-i18n="bio.kicker">Su di me</span></div>
      <h2 class="headline h2" style="margin:0 0 8px" data-i18n="bio.title">Andrea Colucci — Filmmaker & Storyteller</h2>
      <p class="soft" style="margin:0 0 10px" data-i18n="bio.desc">
        Creo video emozionali e ad alto impatto per brand, turismo, barche e real estate. Da autodidatta a regia, con un unico obiettivo: trasformare storie in immagini memorabili.
      </p>
      <ul style="list-style:none;margin:0;padding:0;display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px">
        <li class="chip">300+ progetti</li>
        <li class="chip">Drone 4K certificato</li>
        <li class="chip">Consegne verticali (Reels/Shorts)</li>
        <li class="chip">Color grading professionale</li>
      </ul>
      <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
        <a href="#reel" class="btn" data-i18n="bio.btn.reel">Guarda il Reel</a>
        <a href="#contatti" class="btn fill" data-i18n="bio.btn.contact">Parliamone ora</a>
      </div>
    </div>

    <!-- Immagini -->
    <div class="bio-media" style="position:relative;min-height:240px">
      <img src="/media/about-1.jpg" alt="Andrea Colucci con camera in mano" loading="lazy"
           style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:none">
      <img src="/media/about-2.jpg" alt="Andrea Colucci e collega" loading="lazy"
           style="position:absolute;right:14px;bottom:14px;width:140px;height:140px;object-fit:cover;border-radius:16px;
                  box-shadow:0 10px 24px rgba(0,0,0,.45), 0 0 0 3px rgba(255,255,255,.05)">
      <!-- terza foto SOLO mobile -->
      <img src="/media/hero.webp.jpg" alt="" loading="lazy" class="bio-third-mobile"
           style="display:none;position:absolute;left:14px;top:14px;width:120px;height:120px;object-fit:cover;border-radius:14px;
                  box-shadow:0 8px 20px rgba(0,0,0,.4), 0 0 0 3px rgba(255,255,255,.05)">
      <!-- badge -->
      <div class="glass" style="position:absolute;left:14px;bottom:14px;padding:8px 10px;display:flex;gap:8px;align-items:center">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2l3 7 7 1-5 5 1 7-6-3-6 3 1-7-5-5 7-1 3-7z" stroke="currentColor" stroke-width="1.5"/></svg>
        <span class="soft" style="font-size:13px" data-i18n="bio.badge">Based in Italy • Working in Riviera</span>
      </div>
    </div>
  </div>

  <style>
    .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid var(--stroke);font-size:13px}
    @media (max-width:980px){
      #bio .bio-wrap{grid-template-columns:1fr !important}
      #bio .bio-media{min-height:220px}
    }
    /* Mostra la terza foto solo su schermi piccoli */
    @media (max-width:700px){
      #bio .bio-third-mobile{display:block !important}
    }
  </style>
</section>

<!-- ====== SCRIPT: Click su card/CTA → #contatti + prefill pack (+ WA) ====== -->
<script>
(function(){
  if (window.__PACKS_BOUND) return; // evita doppi binding se la sezione viene inclusa 2 volte
  window.__PACKS_BOUND = true;

  var lastPack = null;

  function smoothToContacts(){
    var t=document.querySelector('#contatti'); if(!t) return;
    var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    t.scrollIntoView({behavior: prefersReduced ? 'auto' : 'smooth', block:'start'});
  }

  function prefillPack(pack){
    lastPack = pack || lastPack;
    window.__LAST_PACK = lastPack || '';
    var qmsg = document.getElementById('q_message');
    if(qmsg){
      var add = 'Pacchetto di interesse: ' + (lastPack || '');
      var current = (qmsg.value||'').trim();
      if(!current.includes(add)){
        qmsg.value = current ? (current + '\n' + add) : add;
      }
    }
    updateWhatsAppLink();
  }

  function updateWhatsAppLink(){
    var wa = document.getElementById('ctaWhatsApp');
    if(!wa) return;
    var cfg = window.__CONFIG || {};
    var waNumber = (cfg.WA_NUMBER || '393910911719').replace(/[^\d]/g,'');
    if(!waNumber) return;

    var p = {
      pack: window.__LAST_PACK || '',
      name: (document.getElementById('q_name')||{}).value || '',
      email: (document.getElementById('q_email')||{}).value || '',
      phone: (document.getElementById('q_phone')||{}).value || '',
      service: (function(){
        var el=document.getElementById('q_service');
        return el && el.value ? (el.options[el.selectedIndex]?.text || el.value) : '';
      })(),
      message: (document.getElementById('q_message')||{}).value || ''
    };

    var lead = (typeof cfg.leadText === 'function') ? cfg.leadText(p) : ('Ciao Andrea! Ti scrivo dal sito.\n' + (p.pack ? ('Pacchetto: '+p.pack+'\n') : ''));
    var text = encodeURIComponent(lead);
    wa.href = 'https://wa.me/'+waNumber+'?text='+text;
  }

  // click sui bottoni "Seleziona"
  document.querySelectorAll('#pacchetti-videoprofessionali .pack-card a[href="#contatti"]').forEach(function(a){
    a.addEventListener('click', function(e){
      var card = a.closest('.pack-card'); if(!card) return;
      var pack = card.getAttribute('data-pack') || (card.querySelector('.headline.h3') && card.querySelector('.headline.h3').textContent) || '';
      e.preventDefault();
      prefillPack(pack);
      smoothToContacts();
    }, {passive:false});
  });

  // click sull'intera card
  document.querySelectorAll('#pacchetti-videoprofessionali .pack-card').forEach(function(card){
    card.addEventListener('click', function(e){
      if(e.target.closest && e.target.closest('a')) return; // già gestito
      var pack = card.getAttribute('data-pack') || (card.querySelector('.headline.h3') && card.querySelector('.headline.h3').textContent) || '';
      e.preventDefault && e.preventDefault();
      prefillPack(pack);
      smoothToContacts();
    }, {passive:false});
  });

  // Aggiorna il bottone WA della CTA quando cliccato (anche senza pack)
  var waBtn = document.getElementById('ctaWhatsApp');
  if(waBtn){
    waBtn.addEventListener('click', function(){
      updateWhatsAppLink();
    }, {passive:true});
  }

  // Aggiorna il link WA se l'utente compila i campi (name/email/phone/message/service)
  ['q_name','q_email','q_phone','q_message','q_service'].forEach(function(id){
    var el = document.getElementById(id);
    if(!el) return;
    var evt = ('oninput' in el) ? 'input' : 'change';
    el.addEventListener(evt, updateWhatsAppLink, {passive:true});
    el.addEventListener('change', updateWhatsAppLink, {passive:true});
  });

  // Prima inizializzazione del link WA
  updateWhatsAppLink();
})();
</script>

<!-- ====== i18n EXTEND (Pacchetti + CTA + Bio) ====== -->
<script>
  (function(){
    function extend(extra){
      window.__i18n = window.__i18n || { __dict:{}, apply:function(){} };
      var D = window.__i18n.__dict = window.__i18n.__dict || {};
      Object.keys(extra).forEach(function(k){ D[k] = Object.assign({}, D[k]||{}, extra[k]); });
      var lang = document.documentElement.lang || 'it';
      if(typeof window.__i18n.apply === 'function'){ window.__i18n.apply(lang); }
    }

    extend({
      it:{
        "packs.title":"Pacchetti Video Commerciali",
        "packs.cta":"Richiedi preventivo",
        "packs.select":"Seleziona",
        "packs.vat":"+ IVA",
        "packs.recommended":"Consigliato",

        "packs.basic.title":"Basic",
        "packs.basic.desc":"Video breve (<1 min), riprese e montaggio base.",
        "packs.basic.price":"€399",

        "packs.standard.title":"Standard",
        "packs.standard.desc":"Promo (<3 min), montaggio avanzato e color grading.",
        "packs.standard.price":"€599",

        "packs.premium.title":"Premium",
        "packs.premium.desc":"Cinematografico (>3 min), storytelling + drone.",
        "packs.premium.price":"€999",

        "packs.elite.title":"Elite Project",
        "packs.elite.desc":"Produzione multi-giorno, multi-location, regia.",
        "packs.elite.price":"€1.999",

        "packs.fullstory.title":"Full Storytelling",
        "packs.fullstory.desc":"Piano completo: main video + short form continuativa.",
        "packs.fullstory.price":"€3.500",

        "cta.headline":"Pronto a dare vita al tuo progetto?",
        "cta.sub":"Risposta in giornata, brief gratuito.",
        "cta.quote":"Richiedi preventivo",
        "cta.whatsapp":"Scrivimi su WhatsApp",

        "bio.kicker":"Su di me",
        "bio.title":"Andrea Colucci — Filmmaker & Storyteller",
        "bio.desc":"Creo video emozionali e ad alto impatto per brand, turismo, barche e real estate. Da autodidatta a regia, con un unico obiettivo: trasformare storie in immagini memorabili.",
        "bio.btn.reel":"Guarda il Reel",
        "bio.btn.contact":"Parliamone ora",
        "bio.badge":"Based in Italy • Working in Riviera"
      },
      en:{
        "packs.title":"Commercial Video Packages",
        "packs.cta":"Get a quote",
        "packs.select":"Select",
        "packs.vat":"+ VAT",
        "packs.recommended":"Recommended",

        "packs.basic.title":"Basic",
        "packs.basic.desc":"Short video (<1 min), basic shoot and edit.",
        "packs.basic.price":"€399",

        "packs.standard.title":"Standard",
        "packs.standard.desc":"Promo (<3 min), advanced editing and color grading.",
        "packs.standard.price":"€599",

        "packs.premium.title":"Premium",
        "packs.premium.desc":"Cinematic (>3 min), storytelling + drone.",
        "packs.premium.price":"€999",

        "packs.elite.title":"Elite Project",
        "packs.elite.desc":"Multi-day, multi-location production, direction.",
        "packs.elite.price":"€1,999",

        "packs.fullstory.title":"Full Storytelling",
        "packs.fullstory.desc":"Complete plan: main video + ongoing short-form.",
        "packs.fullstory.price":"€3,500",

        "cta.headline":"Ready to bring your project to life?",
        "cta.sub":"Same-day reply, free brief.",
        "cta.quote":"Get a quote",
        "cta.whatsapp":"Message on WhatsApp",

        "bio.kicker":"About me",
        "bio.title":"Andrea Colucci — Filmmaker & Storyteller",
        "bio.desc":"I craft emotional, high-impact films for brands, tourism, boats and real estate. Self–taught to directing, turning stories into memorable images.",
        "bio.btn.reel":"Watch the reel",
        "bio.btn.contact":"Let's talk",
        "bio.badge":"Based in Italy • Working in Riviera"
      },
      es:{
        "packs.title":"Paquetes de vídeo comercial",
        "packs.cta":"Pide presupuesto",
        "packs.select":"Seleccionar",
        "packs.vat":"+ IVA",
        "packs.recommended":"Recomendado",

        "packs.basic.title":"Basic",
        "packs.basic.desc":"Vídeo corto (<1 min), rodaje y edición básica.",
        "packs.basic.price":"€399",

        "packs.standard.title":"Standard",
        "packs.standard.desc":"Promo (<3 min), edición avanzada y color.",
        "packs.standard.price":"€599",

        "packs.premium.title":"Premium",
        "packs.premium.desc":"Cinematográfico (>3 min), storytelling + dron.",
        "packs.premium.price":"€999",

        "packs.elite.title":"Elite Project",
        "packs.elite.desc":"Producción multi–día, multi–localización, dirección.",
        "packs.elite.price":"€1.999",

        "packs.fullstory.title":"Full Storytelling",
        "packs.fullstory.desc":"Plan completo: vídeo principal + short–form continuo.",
        "packs.fullstory.price":"€3.500",

        "cta.headline":"¿Listo para dar vida a tu proyecto?",
        "cta.sub":"Respuesta en el día, brief gratuito.",
        "cta.quote":"Pide presupuesto",
        "cta.whatsapp":"Escríbeme por WhatsApp",

        "bio.kicker":"Sobre mí",
        "bio.title":"Andrea Colucci — Filmmaker & Storyteller",
        "bio.desc":"Creo vídeos emocionales y de alto impacto para marcas, turismo, barcos e inmobiliario. De autodidacta a dirección, historias convertidas en imágenes memorables.",
        "bio.btn.reel":"Ver el reel",
        "bio.btn.contact":"Hablemos",
        "bio.badge":"Based in Italy • Working in Riviera"
      }
    });
  })();
</script>
<!-- FINE PARTE 3 / 5 -->


<!-- ==========================
PART 4 / 5 — RECENSIONI • CONTATTI (FIX • foto a sinistra)
========================== -->

<!-- ====== RECENSIONI ====== -->
<section id="recensioni" class="container" style="padding:28px 0 6px">
  <header style="display:flex;align-items:flex-end;justify-content:space-between;gap:10px;margin-bottom:12px">
    <h2 class="headline h2" style="margin:0" data-i18n="reviews.title">Cosa dicono di me</h2>
    <span class="soft" id="avgRatingText" style="white-space:nowrap" data-i18n="reviews.subtitle">Valutazione media 4.9/5</span>
  </header>

  <div class="reviews-wrap" style="position:relative">
    <button class="nav prev" id="reviewsPrev" aria-label="Precedenti" title="Precedenti">◀</button>
    <div id="reviewsViewport" class="glass" style="border-radius:16px;padding:12px;overflow:hidden">
      <div id="reviewsGrid" class="grid" style="display:grid;gap:12px;grid-template-columns:repeat(3,minmax(0,1fr))"></div>
    </div>
    <button class="nav next" id="reviewsNext" aria-label="Successivi" title="Successivi">▶</button>
  </div>

  <div class="review-cta" style="display:flex;justify-content:center;margin-top:12px">
    <button class="btn" id="openReview" data-i18n="reviews.cta">Lascia una recensione</button>
  </div>

  <!-- Modal nuova recensione -->
  <dialog id="reviewModal" style="border:none;border-radius:16px;padding:0;max-width:560px;width:92vw;background:#0a0a0a;color:#fff">
    <form id="reviewForm" method="dialog" style="padding:16px 16px 10px">
      <header style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
        <h3 class="headline h3" style="margin:0" data-i18n="reviews.newTitle">La tua esperienza</h3>
        <button type="button" class="btn" id="closeReview" aria-label="Chiudi">×</button>
      </header>

      <div class="grid" style="gap:10px;grid-template-columns:1fr">
        <div class="field">
          <label class="label" for="r_name" data-i18n="reviews.name">Nome</label>
          <input id="r_name" class="control" type="text" placeholder="Es. Martina P." required>
        </div>

        <div class="field">
          <label class="label" for="r_role" data-i18n="reviews.role">Ruolo</label>
          <input id="r_role" class="control" type="text" placeholder="Es. Marketing, Sposi...">
        </div>

        <div class="field">
          <label class="label" for="r_stars" data-i18n="reviews.rating">Valutazione</label>
          <select id="r_stars" class="control" required>
            <option value="5">★★★★★ — 5</option>
            <option value="4">★★★★☆ — 4</option>
            <option value="3">★★★☆☆ — 3</option>
            <option value="2">★★☆☆☆ — 2</option>
            <option value="1">★☆☆☆☆ — 1</option>
          </select>
        </div>

        <div class="field">
          <label class="label" for="r_img" data-i18n="reviews.photo">Foto (opzionale)</label>
          <input id="r_img" class="control" type="file" accept="image/*,.jpg,.jpeg,.png">
          <small class="soft" data-i18n="reviews.photoHint">PNG/JPG, verrà adattata in miniatura</small>
        </div>

        <div style="display:flex; align-items:center; gap:10px">
          <div id="r_preview_wrap" style="width:54px;height:54px;border-radius:999px;overflow:hidden;border:1px solid var(--stroke);background:rgba(255,255,255,.04);display:grid;place-items:center">
            <img id="r_preview" alt="" style="display:none;width:100%;height:100%;object-fit:cover">
            <span id="r_preview_ph" class="soft" style="font-size:12px">—</span>
          </div>
          <small class="soft" data-i18n="reviews.photoPreview">Anteprima miniatura</small>
        </div>

        <div class="field">
          <label class="label" for="r_text" data-i18n="reviews.text">Recensione</label>
          <textarea id="r_text" class="control" rows="4" placeholder="Scrivi qui la tua recensione…" required></textarea>
        </div>
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button class="btn" type="button" id="cancelReview" data-i18n="common.cancel">Annulla</button>
        <button class="btn fill" id="saveReview" type="button" data-i18n="reviews.save">Pubblica</button>
      </div>
    </form>
  </dialog>

  <!-- JSON-LD (aggregate rating) -->
  <script type="application/ld+json" id="reviewsJsonLd">
  {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "Servizi Video — Andrea Colucci",
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.9",
      "reviewCount": "36"
    }
  }
  </script>

  <style>
    .review .stars{letter-spacing:1px;color:var(--neon1)}
    dialog::backdrop{background:rgba(0,0,0,.6)}
    .field .label{display:block;font-size:13px;margin:0 0 4px;color:#bbb}
    .field .control{
      width:100%;background:rgba(255,255,255,.05);border:1px solid var(--stroke);
      border-radius:10px;color:#fff;padding:10px 12px;outline:none;font-size:17px;line-height:1.35;min-height:44px
    }
    .field .control:focus{box-shadow:0 0 0 2px rgba(117,227,116,.18)}

    .reviews-wrap .nav{
      position:absolute;top:50%;transform:translateY(-50%);
      width:36px;height:36px;border-radius:999px;border:1px solid var(--stroke);
      background:rgba(255,255,255,.06);color:#fff;cursor:pointer;z-index:2
    }
    .reviews-wrap .nav:hover{background:rgba(255,255,255,.1)}
    #reviewsPrev{left:-8px}
    #reviewsNext{right:-8px}
    #reviewsGrid{min-height:280px}

    /* === CARD: immagine a sinistra, nome+ruolo in alto, stelle sotto, testo sotto === */
    .review{
      border:1px solid var(--stroke);background:var(--glass);border-radius:14px;padding:12px;
      display:grid;grid-template-columns:auto 1fr;gap:10px;align-items:start;min-height:140px;overflow:hidden
    }
    .review .media{
      width:54px;height:54px;border-radius:999px;overflow:hidden;border:1px solid var(--stroke);
      grid-column:1; grid-row:1 / span 2;
    }
    .review .media img{width:100%;height:100%;object-fit:cover;display:block}
    .review .body{min-width:0}
    .review .head{display:flex;align-items:baseline;gap:8px;flex-wrap:wrap;min-width:0}
    .review .name{font-weight:800}
    .review .role{color:var(--muted)}
    .review .stars{margin-top:2px;display:block}
    .review p{
      margin:6px 0 0;color:var(--muted);
      overflow-wrap:anywhere;word-break:break-word;hyphens:auto;white-space:normal
    }

    @media (max-width:980px){
      #reviewsGrid{grid-template-columns:1fr !important}
      .reviews-wrap .nav{top:auto;bottom:-16px;transform:none}
      #reviewsPrev{left:6px}
      #reviewsNext{right:6px}
    }

    /* Anti-zoom iOS per modale */
    #reviewModal .control{
      font-size:17px !important; line-height:1.35 !important; min-height:44px !important;
      -webkit-text-size-adjust:100% !important;
    }
    #reviewModal select, #reviewModal option{ font-size:17px !important; }
    #reviewModal ::placeholder{ font-size:17px !important; opacity:.85; }

    /* Fix mobile: mantieni il titolo "Cosa dicono di me" su una sola riga */
@media (max-width: 980px){
  #recensioni header h2{
    white-space: nowrap;
    word-break: keep-all;
    overflow-wrap: normal;
  }
  /* Se lo spazio è troppo stretto, la valutazione scende sotto */
  #recensioni header{
    flex-wrap: wrap;
  }
  #recensioni #avgRatingText{
    flex-basis:100%;
    margin-top:4px;
  }
}

    
  </style>
</section>

<!-- ====== CONTATTI (preventivo) ====== -->
<section id="contatti" class="container" style="padding:22px 0 6px">
  <header style="display:flex;align-items:flex-end;justify-content:space-between;gap:10px;margin-bottom:12px">
    <h2 class="headline h2" style="margin:0" data-i18n="contact.title">Richiedi un preventivo</h2>
    <span class="soft" data-i18n="contact.subtitle">Brief gratuito • risposta in giornata</span>
  </header>

  <div class="glass" style="border-radius:16px;padding:14px">
    <form id="quoteForm" class="grid" style="gap:10px;grid-template-columns:1fr">
      <div class="field">
        <label class="label" for="q_name" data-i18n="contact.name">Nome e Cognome</label>
        <input id="q_name" class="control" type="text" placeholder="Es. Andrea Rossi" required>
      </div>

      <div class="field">
        <label class="label" for="q_email" data-i18n="contact.email">Email</label>
        <input id="q_email" class="control" type="email" placeholder="nome@email.com" required>
      </div>

      <div class="field">
        <label class="label" for="q_service" data-i18n="contact.service">Servizio</label>
        <select id="q_service" class="control" required>
          <option value="" disabled selected data-i18n="contact.service.select">Seleziona…</option>
          <option data-i18n="contact.service.commerciali">Commerciali</option>
          <option data-i18n="contact.service.wedding">Wedding</option>
          <option data-i18n="contact.service.music">Music Video</option>
          <option data-i18n="contact.service.realestate">Real Estate</option>
          <option data-i18n="contact.service.boat">Barche / Charter</option>
          <option data-i18n="contact.service.other">Altro</option>
        </select>
      </div>

      <div class="field">
        <label class="label" for="q_phone" data-i18n="contact.phone">Telefono / WhatsApp</label>
        <input id="q_phone" class="control" type="tel" placeholder="+39 3XX XXX XXXX">
      </div>

      <div class="field">
        <label class="label" for="q_message" data-i18n="contact.message">Messaggio</label>
        <textarea id="q_message" class="control" rows="4" placeholder="Raccontami il tuo progetto, timing, location…"></textarea>
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:flex-end">
        <button type="button" class="btn" id="sendMail" data-i18n="contact.sendEmail">Invia via Email</button>
        <a class="btn fill" id="sendWhatsApp" target="_blank" rel="noopener" data-i18n="contact.sendWA">Invia su WhatsApp</a>
      </div>
    </form>
  </div>

  <style>
    #contatti .control{
      font-size:17px !important; line-height:1.35 !important; min-height:44px !important;
      -webkit-text-size-adjust:100% !important;
    }
    #contatti select, #contatti option{ font-size:17px !important; }
    #contatti ::placeholder{ font-size:17px !important; opacity:.85; }
  </style>
</section>

<!-- ===== SCRIPT: Reviews loader + Carosello + Contatti + Salvataggio ===== -->
<script>
(function(){
  /* ======= CONFIG (arrivano dalla PART 1) ======= */
  var CFG = window.__CONFIG || {};
  var AC_BACKEND_READ = CFG.REVIEWS_READ || '';        // Apps Script READ (JSON)
  var BACKEND_URL     = CFG.REVIEWS_WRITE || '';       // Apps Script WRITE
  var BACKEND_KEY     = CFG.REVIEWS_KEY  || '';        // Secret per WRITE
  var SHEET_URLS      = (CFG.REVIEWS_CSVS||[]);        // opzionale: CSV pubblici
  var SHEET_GVIZ      = CFG.REVIEWS_GVIZ || CFG.REVIEWS_SRC || '';

  /* ======= Utils ======= */
  function starString(n){ n=Math.max(1,Math.min(5,Number(n)||5)); return '★★★★★'.slice(0,n)+'☆☆☆☆☆'.slice(0,5-n); }
  function cleanText(t){ return (t||'').toString().replace(/^“|”$/g,'').trim(); }
  function normalize(rec){
    var o = {
      ts:    (rec.ts!=null ? rec.ts : Date.now()),
      name:  (rec.name||'').trim(),
      role:  (rec.role||'').trim(),
      stars: Number(rec.stars)||5,
      text:  cleanText(rec.text),
      img:   rec.img||''
    };
    if(typeof o.ts === 'string'){ var d=new Date(o.ts); if(!isNaN(d)) o.ts = d.getTime(); }
    return o;
  }
  function sigKey(r){
    var d = new Date(Number(r.ts)||Date.now());
    var day = d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate();
    var snippet = cleanText(r.text).slice(0,24).toLowerCase();
    return [ (r.name||'').toLowerCase(), (r.stars||5), snippet, day ].join('|');
  }
  function dedupeMerge(arrays){
    var map = new Map();
    arrays.forEach(function(arr){
      (arr||[]).forEach(function(x){
        var r = normalize(x), k = sigKey(r);
        if(!map.has(k)) map.set(k, r);
      });
    });
    return Array.from(map.values());
  }

  /* ======= Rendering card: IMG a sinistra ======= */
  function appendCardTo(el, rec){
    var r = normalize(rec);
    var fig = document.createElement('figure');
    fig.className = 'review';

    // immagine sinistra
    var media = document.createElement('div');
    media.className = 'media';
    var img = document.createElement('img');
    var fallback = ['/media/client-1.jpg','/media/client-2.jpg','/media/client-3.jpg'][Math.floor(Math.random()*3)];
    img.src = (r.img && (''+r.img).trim()) ? (''+r.img).trim() : fallback;
    img.alt = 'Cliente';
    media.appendChild(img);

    // corpo destro
    var body = document.createElement('div');
    body.className = 'body';
    var head = document.createElement('div');
    head.className = 'head';

    var name = document.createElement('strong');
    name.className = 'name';
    name.textContent = r.name || 'Cliente';

    var sep = document.createElement('span');
    sep.textContent = '·';
    sep.setAttribute('aria-hidden','true');
    sep.style.opacity = '.6';

    var role = document.createElement('span');
    role.className = 'role';
    role.textContent = r.role || (document.documentElement.lang==='en'?'Client':'Cliente');

    var stars = document.createElement('span');
    stars.className = 'stars';
    stars.setAttribute('aria-label',(r.stars||5)+' su 5');
    stars.textContent = starString(r.stars);

    var p = document.createElement('p');
    p.className = 'soft';
    p.textContent = '“'+(r.text||'')+'”';

    head.appendChild(name);
    head.appendChild(sep);
    head.appendChild(role);
    body.appendChild(head);
    body.appendChild(stars);
    body.appendChild(p);

    fig.appendChild(media);
    fig.appendChild(body);
    el.appendChild(fig);
  }

  function updateAggregate(avgEl, jsonLdEl, arr){
  if(!arr || !arr.length) return;
  var count = arr.length;
  var avg = Math.round((arr.reduce(function(a,b){return a+(Number(b.stars)||0);},0)/count)*10)/10;

  if(avgEl){
    var lang = document.documentElement.lang || 'it';
    var label =
      lang==='en' ? ('Average rating '+avg+'/5 • Reviews: '+count) :
      lang==='es' ? ('Valoración media '+avg+'/5 • Reseñas: '+count) :
                    ('Valutazione media '+avg+'/5 • Recensioni: '+count);
    avgEl.textContent = label;
  }

  if(jsonLdEl){
    try{
      var obj = JSON.parse(jsonLdEl.textContent);
      obj.aggregateRating.ratingValue = String(avg);
      obj.aggregateRating.reviewCount = String(count);
      jsonLdEl.textContent = JSON.stringify(obj);
    }catch(_){}
  }
}


  /* ======= Letture sorgenti ======= */
  function fetchCSV(url){
    return fetch(url, {cache:'no-store'}).then(function(r){ if(!r.ok) throw new Error(r.status); return r.text(); });
  }
  function parseCSV(csv){
    var lines = csv.split(/\r?\n/).filter(Boolean);
    if(!lines.length) return [];
    var head = lines[0].split(',').map(function(s){return s.trim().toLowerCase();});
    var idx  = { ts: head.indexOf('ts'), name: head.indexOf('name'), role: head.indexOf('role'),
                 stars: head.indexOf('stars'), text: head.indexOf('text'), img: head.indexOf('img') };
    var out=[];
    for(var i=1;i<lines.length;i++){
      var parts=[], cur='', inq=false, row=lines[i];
      for(var k=0;k<row.length;k++){
        var ch=row[k];
        if(ch=='"'){ if(inq && row[k+1]=='"'){cur+='"'; k++;} else inq=!inq; }
        else if(ch==',' && !inq){ parts.push(cur); cur=''; }
        else cur+=ch;
      }
      parts.push(cur);
      out.push(normalize({
        ts:   idx.ts>=0 ? Number(parts[idx.ts]) : Date.now(),
        name: idx.name>=0 ? parts[idx.name] : '',
        role: idx.role>=0 ? parts[idx.role] : '',
        stars: idx.stars>=0 ? parseInt(parts[idx.stars]||'5',10) : 5,
        text: idx.text>=0 ? parts[idx.text] : '',
        img:  idx.img>=0 ? parts[idx.img] : ''
      }));
    }
    return out;
  }
  function fetchGVIZ(url){
    return fetch(url, {cache:'no-store'}).then(function(r){ if(!r.ok) throw new Error(r.status); return r.text(); });
  }
  function parseGVIZ(text){
    var s = text.indexOf('('), e = text.lastIndexOf(')');
    var json = JSON.parse(text.slice(s+1, e));
    var rows = (json.table && json.table.rows) || [];
    var out = [];
    for(var k=0;k<rows.length;k++){
      var r = rows[k]; if(!r || !r.c) continue;
      var o = {
        ts:    r.c[0] && (r.c[0].v!=null ? r.c[0].v : r.c[0].f),
        name:  r.c[1] && (r.c[1].v!=null ? r.c[1].v : r.c[1].f),
        role:  r.c[2] && (r.c[2].v!=null ? r.c[2].v : r.c[2].f),
        stars: r.c[3] && (r.c[3].v!=null ? r.c[3].v : r.c[3].f),
        text:  r.c[4] && (r.c[4].v!=null ? r.c[4].v : r.c[4].f),
        img:   r.c[5] && (r.c[5].v!=null ? r.c[5].v : r.c[5].f)
      };
      if(o.stars!=null) o.stars = Number(String(o.stars).replace(',','.')) || 5;
      if(o.ts){ var d=new Date(o.ts); if(!isNaN(d)) o.ts = d.getTime(); }
      o.text = cleanText(o.text);
      out.push(normalize(o));
    }
    return out;
  }

  var ALL = [];

  async function loadFromBackend(){
    if(!AC_BACKEND_READ) return [];
    try{
      var r = await fetch(AC_BACKEND_READ, {cache:'no-store'});
      if(!r.ok) throw new Error('HTTP '+r.status);
      var j = await r.json();
      if(j && j.ok && Array.isArray(j.items)) return j.items.map(normalize);
    }catch(_){}
    return [];
  }
  async function loadFromCSVs(){
    if(!SHEET_URLS.length) return [];
    for(var i=0;i<SHEET_URLS.length;i++){
      try{
        var csv = await fetchCSV(SHEET_URLS[i]);
        var arr = parseCSV(csv);
        if(arr.length) return arr;
      }catch(_){}
    }
    return [];
  }
  async function loadFromGVIZ(){
    if(!SHEET_GVIZ) return [];
    try{
      var txt = await fetchGVIZ(SHEET_GVIZ);
      return parseGVIZ(txt);
    }catch(_){ return []; }
  }
  function loadFromStore(){
    try{
      var st = window.__reviewsStore;
      if(st && Array.isArray(st.data) && st.data.length) return st.data.map(normalize);
    }catch(_){}
    return [];
  }
  function loadFromCache(){
    try{
      var cache = JSON.parse(localStorage.getItem('__ac_reviews_cache')||'[]');
      if(Array.isArray(cache) && cache.length) return cache.map(normalize);
    }catch(_){}
    return [];
  }

  async function loadReviews(){
    var sourceStore   = loadFromStore();
    var sourceBackend = await loadFromBackend();
    var sourceCSV     = await loadFromCSVs();
    var sourceGVIZ    = await loadFromGVIZ();
    var sourceCache   = loadFromCache();

    var merged = dedupeMerge([sourceStore, sourceBackend, sourceCSV, sourceGVIZ, sourceCache]);
    merged.sort(function(a,b){ return (Number(b.ts)||0) - (Number(a.ts)||0); });

    ALL = merged;
    try{ localStorage.setItem('__ac_reviews_cache', JSON.stringify(ALL)); }catch(_){}

    renderPage(0, true);
    updateAggregate(document.getElementById('avgRatingText'), document.getElementById('reviewsJsonLd'), ALL);
  }

  window.addEventListener('ac:reviews-ready', function(){ loadReviews(); });

  /* ======= Carosello paginato ======= */
  var cur = 0;
  function pageSize(){ return (window.matchMedia && window.matchMedia('(max-width:980px)').matches) ? 3 : 6; }
  function totalPages(){ var p = pageSize(); return Math.max(1, Math.ceil(ALL.length / p)); }
  function renderPage(index, force){
    var max = totalPages();
    if(max>0){ if(!force) index = (index+max)%max; } else { index = 0; }
    cur = index;

    var grid = document.getElementById('reviewsGrid');
    if(!grid) return;
    grid.innerHTML='';

    var ps = pageSize();
    var start = cur*ps, end = Math.min(start+ps, ALL.length);
    var slice = ALL.slice(start, end);

    if(!slice.length && !ALL.length){
      slice = [
        {name:'Giulia R.', role:'Hotel Manager', stars:5, text:'Video emozionale perfetto per la homepage.'},
        {name:'Marco D.', role:'Boat Charter',  stars:5, text:'Riprese drone incredibili, zero stress sul set.'},
        {name:'Sara & Luca', role:'Wedding',    stars:4, text:'Trailer per Instagram che ha fatto il botto.'}
      ];
    }
    for(var i=0;i<slice.length;i++) appendCardTo(grid, slice[i]);
    grid.style.gridTemplateColumns = (ps===6 ? 'repeat(3,minmax(0,1fr))' : '1fr');
  }

  var prev = document.getElementById('reviewsPrev');
  var next = document.getElementById('reviewsNext');
  if(prev) prev.addEventListener('click', function(){ renderPage(cur-1); });
  if(next) next.addEventListener('click', function(){ renderPage(cur+1); });

  var rzTO=null, lastPS=pageSize();
  window.addEventListener('resize', function(){
    clearTimeout(rzTO);
    rzTO=setTimeout(function(){
      var nowPS=pageSize();
      if(nowPS!==lastPS){ lastPS=nowPS; renderPage(0, true); }
    }, 120);
  }, {passive:true});

  /* ======= Modale Recensioni (preview + save) ======= */
  var form     = document.getElementById('reviewForm');
  var dialog   = document.getElementById('reviewModal');
  var openBtn  = document.getElementById('openReview');
  var closeBtn = document.getElementById('closeReview');
  var cancelBtn= document.getElementById('cancelReview');
  var saveBtn  = document.getElementById('saveReview');
  var fileIn   = document.getElementById('r_img');
  var preview  = document.getElementById('r_preview');
  var previewPh= document.getElementById('r_preview_ph');

  function toDataUrlThumb(file, cb){
    try{
      var fr=new FileReader();
      fr.onload=function(){
        var img=new Image();
        img.onload=function(){
          var size=120, c=document.createElement('canvas'), ctx=c.getContext('2d');
          c.width=size; c.height=size;
          var s=Math.min(img.width,img.height), sx=(img.width-s)/2, sy=(img.height-s)/2;
          ctx.drawImage(img, sx, sy, s, s, 0, 0, size, size);
          cb(null, c.toDataURL('image/jpeg', .85));
        };
        img.src=fr.result;
      };
      fr.readAsDataURL(file);
    }catch(e){ cb(e); }
  }
  if(fileIn) fileIn.addEventListener('change', function(){
    var f = this.files && this.files[0];
    if(!f || !f.type || f.type.indexOf('image/')!==0){
      if(preview) preview.style.display='none';
      if(previewPh) previewPh.style.display='block';
      return;
    }
    toDataUrlThumb(f, function(err, data){
      if(err){ if(preview) preview.style.display='none'; if(previewPh) previewPh.style.display='block'; return; }
      if(preview){ preview.src = data; preview.style.display='block'; }
      if(previewPh) previewPh.style.display='none';
    });
  });

  function buildRecord(){
    var nameEl=document.getElementById('r_name');
    var roleEl=document.getElementById('r_role');
    var starEl=document.getElementById('r_stars');
    var textEl=document.getElementById('r_text');
    var name = nameEl ? (nameEl.value||'') : '';
    var role = roleEl ? (roleEl.value||'') : '';
    var stars= starEl ? parseInt(starEl.value||'5',10) : 5;
    var text = textEl ? (textEl.value||'') : '';
    var img64= (preview && preview.src && preview.style.display!=='none') ? preview.src : '';
    if(!name || !text) return null;
    return { name:name.trim(), role:role.trim(), stars:Math.max(1,Math.min(5,stars||5)), text:text.trim(), img:img64, ts: Date.now() };
  }
  function resetModal(){
    try{ if(form) form.reset(); }catch(_){}
    if(preview) preview.style.display='none';
    if(previewPh) previewPh.style.display='block';
  }
  function closeModal(){
    resetModal();
    if(dialog){ if(dialog.open) dialog.close(); else dialog.removeAttribute('open'); }
  }
  function openModal(){ if(dialog){ if(dialog.showModal) dialog.showModal(); else dialog.setAttribute('open','open'); } }
  if(openBtn)  openBtn.addEventListener('click', openModal);
  if(closeBtn) closeBtn.addEventListener('click', closeModal);
  if(cancelBtn)cancelBtn.addEventListener('click', closeModal);
  if(dialog){
    dialog.addEventListener('keydown', function(e){ if(e.key==='Escape'){ e.preventDefault(); closeModal(); } });
    dialog.addEventListener('click', function(e){
      var r = dialog.getBoundingClientRect();
      var inside = (e.clientX>=r.left && e.clientX<=r.right && e.clientY>=r.top && e.clientY<=r.bottom);
      if(!inside) closeModal();
    });
  }

  async function saveToBackend(rec){
  if(!BACKEND_URL || !BACKEND_KEY) return;
  try{
    const res = await fetch(BACKEND_URL, {
      method:'POST',
      headers:{ 'Content-Type':'text/plain;charset=utf-8' }, // <— cambiato da application/json
      body: JSON.stringify({
        key:   BACKEND_KEY,
        name:  rec.name,
        role:  rec.role,
        stars: rec.stars,
        text:  rec.text,
        img:   rec.img
      })
    });
    const j = await res.json().catch(()=>({}));
    console.log('[reviews] write result:', j);
    // rilettura dopo append su Sheet
    setTimeout(loadReviews, 800);
  }catch(err){
    console.error('[reviews] write error:', err);
  }
}


  function handleSave(e){
    if(e && e.preventDefault) e.preventDefault();
    var rec = buildRecord(); if(!rec) return;
    // UI + cache immediata
    var merged = dedupeMerge([ALL, [rec]]);
    merged.sort(function(a,b){ return (Number(b.ts)||0) - (Number(a.ts)||0); });
    ALL = merged;
    try{ localStorage.setItem('__ac_reviews_cache', JSON.stringify(ALL)); }catch(_){}
    renderPage(0, true);
    updateAggregate(document.getElementById('avgRatingText'), document.getElementById('reviewsJsonLd'), ALL);
    closeModal();
    // Salva su Apps Script (-> Google Sheet)
    saveToBackend(rec);
  }

  if(form)   form.addEventListener('submit', handleSave);
  if(saveBtn) saveBtn.addEventListener('click', handleSave); /* FIX: listener corretto */

  /* ======= Contatti: Email + WhatsApp ======= */
  function val(id){ var el=document.getElementById(id); return el ? (el.value||'').trim() : ''; }
  function buildPayload(){
    var sEl=document.getElementById('q_service');
    var service = (sEl && sEl.value) ? sEl.options[sEl.selectedIndex].text : '';
    return {
      pack:   (window.__LAST_PACK || ''),
      name:   val('q_name'),
      email:  val('q_email'),
      phone:  val('q_phone'),
      service:service,
      message:val('q_message')
    };
  }
  function buildMailBody(p){
    return (
      "Richiesta preventivo dal sito Andrea Colucci Films\n\n" +
      (p.pack ? ("Pacchetto: " + p.pack + "\n\n") : "") +
      "Nome: " + (p.name || '-') + "\n" +
      "Email: " + (p.email || '-') + "\n" +
      "Telefono/WA: " + (p.phone || '-') + "\n" +
      "Servizio: " + (p.service || '-') + "\n\n" +
      (p.message ? ("Messaggio:\n" + p.message) : "")
    );
  }
  var mailBtn = document.getElementById('sendMail');
  if(mailBtn){
    mailBtn.addEventListener('click', function(e){
      e.preventDefault();
      var p = buildPayload();
      var subject = encodeURIComponent("Richiesta preventivo — Andrea Colucci Films");
      var body    = encodeURIComponent(buildMailBody(p));
      location.href = "mailto:" + ( (window.__CONFIG&&window.__CONFIG.EMAIL) || "andreacolucci@hotmail.it") + "?subject="+subject+"&body="+body;
    });
  }
  var waBtn = document.getElementById('sendWhatsApp');
  if(waBtn){
    waBtn.addEventListener('click', function(){
      var p = buildPayload();
      var cfg = window.__CONFIG || {};
      var waNumber = (cfg.WA_NUMBER || '393910911719').replace(/[^\d]/g,'');
      var text = encodeURIComponent((cfg.leadText ? cfg.leadText(p) : 'Ciao Andrea! Ti scrivo dal sito 🙌'));
      waBtn.href = "https://wa.me/" + waNumber + "?text=" + text;
    });
  }

  // Avvio
  loadReviews();
})();
</script>

<!-- ===== i18n EXTEND (Reviews + Contatti) ===== -->
<script>
(function(){
  function extend(extra){
    window.__i18n = window.__i18n || { __dict:{}, apply:function(){} };
    var D = window.__i18n.__dict = window.__i18n.__dict || {};
    Object.keys(extra).forEach(function(k){ D[k] = Object.assign({}, D[k]||{}, extra[k]); });
    var lang = document.documentElement.lang || 'it';
    if(typeof window.__i18n.apply === 'function'){ window.__i18n.apply(lang); }
  }

  extend({
    it:{
      "reviews.title":"Cosa dicono di me",
      "reviews.subtitle":"Valutazione media 4.9/5",
      "reviews.cta":"Lascia una recensione",
      "reviews.newTitle":"La tua esperienza",
      "reviews.name":"Nome",
      "reviews.role":"Ruolo",
      "reviews.rating":"Valutazione",
      "reviews.photo":"Foto (opzionale)",
      "reviews.photoHint":"PNG/JPG, verrà adattata in miniatura",
      "reviews.photoPreview":"Anteprima miniatura",
      "reviews.text":"Recensione",
      "reviews.save":"Pubblica",
      "common.cancel":"Annulla",

      "contact.title":"Richiedi un preventivo",
      "contact.subtitle":"Brief gratuito • risposta in giornata",
      "contact.name":"Nome e Cognome",
      "contact.email":"Email",
      "contact.phone":"Telefono / WhatsApp",
      "contact.service":"Servizio",
      "contact.service.select":"Seleziona…",
      "contact.service.commerciali":"Commerciali",
      "contact.service.wedding":"Wedding",
      "contact.service.music":"Music Video",
      "contact.service.realestate":"Real Estate",
      "contact.service.boat":"Barche / Charter",
      "contact.service.other":"Altro",
      "contact.message":"Messaggio",
      "contact.sendEmail":"Invia via Email",
      "contact.sendWA":"Invia su WhatsApp"
    },
    en:{
      "reviews.title":"What clients say",
      "reviews.subtitle":"Average rating 4.9/5",
      "reviews.cta":"Leave a review",
      "reviews.newTitle":"Your experience",
      "reviews.name":"Name",
      "reviews.role":"Role",
      "reviews.rating":"Rating",
      "reviews.photo":"Photo (optional)",
      "reviews.photoHint":"PNG/JPG, will be cropped as a thumbnail",
      "reviews.photoPreview":"Thumbnail preview",
      "reviews.text":"Review",
      "reviews.save":"Publish",
      "common.cancel":"Cancel",

      "contact.title":"Request a quote",
      "contact.subtitle":"Free brief • same-day reply",
      "contact.name":"Full name",
      "contact.email":"Email",
      "contact.phone":"Phone / WhatsApp",
      "contact.service":"Service",
      "contact.service.select":"Select…",
      "contact.service.commerciali":"Commercial",
      "contact.service.wedding":"Wedding",
      "contact.service.music":"Music Video",
      "contact.service.realestate":"Real Estate",
      "contact.service.boat":"Boats / Charter",
      "contact.service.other":"Other",
      "contact.message":"Message",
      "contact.sendEmail":"Send via Email",
      "contact.sendWA":"Send on WhatsApp"
    },
    es:{
      "reviews.title":"Qué dicen de mí",
      "reviews.subtitle":"Valoración media 4.9/5",
      "reviews.cta":"Deja una reseña",
      "reviews.newTitle":"Tu experiencia",
      "reviews.name":"Nombre",
      "reviews.role":"Cargo",
      "reviews.rating":"Valoración",
      "reviews.photo":"Foto (opcional)",
      "reviews.photoHint":"PNG/JPG, se adaptará a miniatura",
      "reviews.photoPreview":"Vista previa miniatura",
      "reviews.text":"Reseña",
      "reviews.save":"Publicar",
      "common.cancel":"Cancelar",

      "contact.title":"Pide un presupuesto",
      "contact.subtitle":"Brief gratuito • respuesta en el día",
      "contact.name":"Nombre y Apellidos",
      "contact.email":"Email",
      "contact.phone":"Teléfono / WhatsApp",
      "contact.service":"Servicio",
      "contact.service.select":"Seleccionar…",
      "contact.service.commerciali":"Comercial",
      "contact.service.wedding":"Boda",
      "contact.service.music":"Vídeo musical",
      "contact.service.realestate":"Inmobiliario",
      "contact.service.boat":"Barcos / Charter",
      "contact.service.other":"Otro",
      "contact.message":"Mensaje",
      "contact.sendEmail":"Enviar por Email",
      "contact.sendWA":"Enviar por WhatsApp"
    }
  });
})();
</script>
<!-- FINE PARTE 4 / 5 -->

<!-- ==========================
PART 5 / 5 — FOOTER • POLICY • UTILITY FINALI (fix)
(look identico; mobile compatto e centrato; WA dinamico da __CONFIG; i18n esteso)
========================== -->

<!-- ====== FOOTER (neo–dark compatto) ====== -->
<footer id="footer" class="container" style="padding:24px 0 18px">
  <div class="glass" style="
      border-radius:18px;overflow:hidden;position:relative;
      background:
        radial-gradient(1200px 400px at 80% 120%, rgba(77,225,75,.06), transparent 50%),
        rgba(255,255,255,.04)">
    <!-- background con immagine scuretta per leggibilità -->
    <div style="
        background:url('/media/bg-contact.webp.jpg') center/cover no-repeat;
        filter:brightness(.58) contrast(1.06) saturate(1.06);
        position:absolute;inset:0;z-index:0"></div>

    <!-- overlay -->
    <div style="position:absolute;inset:0;
                background:linear-gradient(to bottom, rgba(10,10,10,.08), rgba(10,10,10,.62) 40%, rgba(10,10,10,.94));
                z-index:1"></div>

    <!-- contenuto -->
    <div style="position:relative;z-index:2;padding:18px 14px">
      <div class="grid" style="gap:14px;grid-template-columns:2fr 1fr 1fr">
        <!-- blocco 1 -->
        <div>
          <h3 class="headline h3" style="margin:0 0 6px">Andrea Colucci</h3>
          <p class="soft" style="margin:0 0 10px;max-width:46ch" data-i18n="footer.about">
            Filmmaker e storyteller visivo. Commerciali, Wedding, Music Video, Real Estate, Charter.
          </p>

          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <a class="btn" href="mailto:andreacolucci@hotmail.it" aria-label="Email">Email</a>
            <a class="btn" id="footerWA" target="_blank" rel="noopener" aria-label="WhatsApp">WhatsApp</a>
            <a class="btn" href="#contatti" aria-label="Richiedi preventivo" data-i18n="footer.quote">Preventivo</a>
          </div>
        </div>

        <!-- blocco 2 -->
        <nav aria-label="Sezioni">
          <h4 class="soft" style="margin:0 0 8px;font-size:13px;text-transform:uppercase;letter-spacing:.04em" data-i18n="footer.sections">Sezioni</h4>
          <ul style="list-style:none;margin:0;padding:0;display:grid;gap:6px">
            <li><a class="link" href="#reel" data-i18n="footer.link.reel">Showreel</a></li>
            <li><a class="link" href="#servizi" data-i18n="footer.link.services">Servizi</a></li>
            <li><a class="link" href="#pacchetti-videoprofessionali" data-i18n="footer.link.packs">Pacchetti</a></li>
            <li><a class="link" href="#recensioni" data-i18n="footer.link.reviews">Recensioni</a></li>
            <li><a class="link" href="#contatti" data-i18n="footer.link.contacts">Contatti</a></li>
          </ul>
        </nav>

        <!-- blocco 3 -->
        <div>
          <h4 class="soft" style="margin:0 0 8px;font-size:13px;text-transform:uppercase;letter-spacing:.04em">Social</h4>
          <ul style="list-style:none;margin:0;padding:0;display:grid;gap:6px">
            <li><a class="link" href="https://instagram.com/andrecolu_video" target="_blank" rel="noopener">Instagram</a></li>
            <li><a class="link" href="https://youtube.com/@andrecolu_video" target="_blank" rel="noopener">YouTube</a></li>
            <li><a class="link" href="https://vimeo.com/andrecolu_video" target="_blank" rel="noopener">Vimeo</a></li>
          </ul>
        </div>
      </div>

      <div style="margin-top:14px;border-top:1px solid var(--stroke);padding-top:10px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between">
        <small class="soft">© 2025 Andrea Colucci — All rights reserved</small>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <a class="link" href="#privacy" data-i18n="footer.privacy">Privacy</a>
          <a class="link" href="#cookie" data-i18n="footer.cookie">Cookie</a>
          <a class="link" href="#terms" data-i18n="footer.terms">Termini</a>
          <button id="toTop" class="btn" aria-label="Torna su" title="Top">↑</button>
        </div>
      </div>
    </div>
  </div>

  <!-- responsive fix footer -->
  <style>
    @media (max-width:900px){
      #footer .grid{ grid-template-columns:1fr 1fr !important }
    }
    @media (max-width:640px){
      #footer .grid{ grid-template-columns:1fr !important }
      #footer .btn{ padding:10px 14px; }
    }
  </style>
</footer>

<!-- ====== POLICY (accordion compatto) ====== -->
<section id="policy" class="container" style="padding:10px 0 24px">
  <div class="grid" style="gap:10px;grid-template-columns:1fr 1fr 1fr">
    <!-- Privacy -->
    <details id="privacy" class="glass" style="border-radius:14px;padding:12px">
      <summary class="headline h5" style="cursor:pointer" data-i18n="policy.privacy.t">Privacy Policy</summary>
      <div class="soft" style="margin-top:8px;line-height:1.55">
        <p data-i18n="policy.privacy.p1">Questo sito raccoglie alcuni dati personali (es. indirizzo IP) esclusivamente per statistiche e sicurezza. Nessun dato sensibile o marketing.</p>
        <p data-i18n="policy.privacy.p2">I dati sono conservati in modo sicuro e non ceduti a terzi. Puoi chiedere la cancellazione scrivendo a <a class="link" href="mailto:andreacolucci@hotmail.it">andreacolucci@hotmail.it</a>.</p>
      </div>
    </details>

    <!-- Cookie -->
    <details id="cookie" class="glass" style="border-radius:14px;padding:12px">
      <summary class="headline h5" style="cursor:pointer" data-i18n="policy.cookie.t">Cookie Policy</summary>
      <div class="soft" style="margin-top:8px;line-height:1.55">
        <p data-i18n="policy.cookie.p1">Usiamo solo cookie tecnici per il corretto funzionamento. Puoi disattivarli dal browser, ma alcune funzioni potrebbero limitarsi.</p>
        <p data-i18n="policy.cookie.p2">Per info: <a class="link" href="mailto:andreacolucci@hotmail.it">andreacolucci@hotmail.it</a>.</p>
      </div>
    </details>

    <!-- Termini -->
    <details id="terms" class="glass" style="border-radius:14px;padding:12px">
      <summary class="headline h5" style="cursor:pointer" data-i18n="policy.terms.t">Terms of Service</summary>
      <div class="soft" style="margin-top:8px;line-height:1.55">
        <p data-i18n="policy.terms.p1">Tutti i contenuti (video, testi, immagini) sono © Andrea Colucci. È vietata la riproduzione senza autorizzazione scritta.</p>
        <p data-i18n="policy.terms.p2">Il sito è fornito “così com’è”, senza garanzie. Nessuna responsabilità per danni derivanti dall’uso.</p>
      </div>
    </details>
  </div>

  <!-- responsive fix policy -->
  <style>
    @media (max-width:900px){
      #policy .grid{ grid-template-columns:1fr 1fr !important }
    }
    @media (max-width:640px){
      #policy .grid{ grid-template-columns:1fr !important }
    }
  </style>
</section>

<!-- ====== SCRIPT utility footer/policy/i18n ====== -->
<script>
(function(){
  // Back-to-top (rispetta prefers-reduced-motion)
  var btn = document.getElementById('toTop');
  if(btn){
    btn.addEventListener('click', function(e){
      e.preventDefault();
      var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      window.scrollTo({ top:0, behavior: prefersReduced ? 'auto' : 'smooth' });
    }, {passive:false});
  }

  // WhatsApp nel footer: genera sempre testo live dai campi del form (se presenti)
  (function(){
    var wa = document.getElementById('footerWA');
    if(!wa) return;
    function payload(){
      var q = function(id){ var el=document.getElementById(id); return el? (el.value||'').trim() : ''; };
      return {
        pack:(window.__LAST_PACK||''),
        name:q('q_name'),
        email:q('q_email'),
        phone:q('q_phone'),
        service:(function(){ var el=document.getElementById('q_service'); return el&&el.value? el.options[el.selectedIndex].text : ''; })(),
        message:q('q_message')
      };
    }
    function updateWA(){
      var cfg = window.__CONFIG || {};
      var number = (cfg.WA_NUMBER || '393910911719').replace(/[^\d]/g,'');
      var text = encodeURIComponent( (cfg.leadText ? cfg.leadText(payload()) : 'Ciao Andrea! Ti scrivo dal sito 🙌') );
      wa.href = 'https://wa.me/' + number + '?text=' + text;
    }
    // aggiorna al click e quando cambiano i campi noti
    wa.addEventListener('click', updateWA);
    ['q_name','q_email','q_phone','q_service','q_message'].forEach(function(id){
      var el=document.getElementById(id); if(!el) return;
      el.addEventListener('input', updateWA, {passive:true});
      el.addEventListener('change', updateWA, {passive:true});
    });
    updateWA();
  })();

  // Apri details da hash (Privacy/Cookie/Termini) + scroll morbido
  (function(){
    function openFromHash(){
      if(!location.hash) return;
      var el = document.querySelector(location.hash);
      if(el && el.tagName === 'DETAILS' && !el.open){ el.open = true; }
      if(el){
        var prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        el.scrollIntoView({behavior: prefersReduced ? 'auto' : 'smooth', block:'start'});
      }
    }
    window.addEventListener('hashchange', function(){ setTimeout(openFromHash, 0); }, {passive:true});
    setTimeout(openFromHash, 0);
  })();

  // i18n EXTEND per Footer/Policy (coerente con Parti 1–4)
  (function(){
    window.__i18n = window.__i18n || { __dict:{}, apply:function(){} };
    function extend(extra){
      var D = (window.__i18n.__dict = window.__i18n.__dict || {});
      Object.keys(extra).forEach(function(k){
        D[k] = Object.assign({}, D[k]||{}, extra[k]);
      });
      var lang = document.documentElement.lang || 'it';
      if(typeof window.__i18n.apply === 'function'){ window.__i18n.apply(lang); }
    }

    extend({
      it:{
        "footer.about":"Filmmaker e storyteller visivo. Commerciali, Wedding, Music Video, Real Estate, Charter.",
        "footer.quote":"Preventivo",
        "footer.sections":"Sezioni",
        "footer.link.reel":"Showreel",
        "footer.link.services":"Servizi",
        "footer.link.packs":"Pacchetti",
        "footer.link.reviews":"Recensioni",
        "footer.link.contacts":"Contatti",
        "footer.privacy":"Privacy",
        "footer.cookie":"Cookie",
        "footer.terms":"Termini",

        "policy.privacy.t":"Privacy Policy",
        "policy.privacy.p1":"Questo sito raccoglie alcuni dati personali (es. indirizzo IP) esclusivamente per statistiche e sicurezza. Nessun dato sensibile o marketing.",
        "policy.privacy.p2":"I dati sono conservati in modo sicuro e non ceduti a terzi. Puoi chiedere la cancellazione scrivendo a andreacolucci@hotmail.it.",

        "policy.cookie.t":"Cookie Policy",
        "policy.cookie.p1":"Usiamo solo cookie tecnici per il corretto funzionamento. Puoi disattivarli nel browser, ma alcune funzioni potrebbero limitarsi.",
        "policy.cookie.p2":"Per info: andreacolucci@hotmail.it.",

        "policy.terms.t":"Terms of Service",
        "policy.terms.p1":"Tutti i contenuti (video, testi, immagini) sono © Andrea Colucci. È vietata la riproduzione senza autorizzazione scritta.",
        "policy.terms.p2":"Il sito è fornito “così com’è”, senza garanzie. Nessuna responsabilità per danni derivanti dall’uso."
      },
      en:{
        "footer.about":"Filmmaker and visual storyteller. Commercial, Wedding, Music Video, Real Estate, Charter.",
        "footer.quote":"Get a quote",
        "footer.sections":"Sections",
        "footer.link.reel":"Showreel",
        "footer.link.services":"Services",
        "footer.link.packs":"Packages",
        "footer.link.reviews":"Reviews",
        "footer.link.contacts":"Contacts",
        "footer.privacy":"Privacy",
        "footer.cookie":"Cookie",
        "footer.terms":"Terms",

        "policy.privacy.t":"Privacy Policy",
        "policy.privacy.p1":"This site collects some personal data (e.g., IP address) only for statistics and security. No sensitive data or marketing.",
        "policy.privacy.p2":"Data is stored securely and not shared with third parties. You can request deletion at andreacolucci@hotmail.it.",

        "policy.cookie.t":"Cookie Policy",
        "policy.cookie.p1":"We only use technical cookies for proper operation. You can disable them in your browser, but some features may be limited.",
        "policy.cookie.p2":"Info: andreacolucci@hotmail.it.",

        "policy.terms.t":"Terms of Service",
        "policy.terms.p1":"All content (videos, texts, images) is © Andrea Colucci. Reproduction without written permission is prohibited.",
        "policy.terms.p2":"The site is provided “as is”, without warranties. No liability for damages resulting from its use."
      },
      es:{
        "footer.about":"Filmmaker y narrador visual. Comercial, Bodas, Videoclip, Inmobiliario, Charter.",
        "footer.quote":"Pide presupuesto",
        "footer.sections":"Secciones",
        "footer.link.reel":"Showreel",
        "footer.link.services":"Servicios",
        "footer.link.packs":"Paquetes",
        "footer.link.reviews":"Reseñas",
        "footer.link.contacts":"Contactos",
        "footer.privacy":"Privacidad",
        "footer.cookie":"Cookies",
        "footer.terms":"Términos",

        "policy.privacy.t":"Política de Privacidad",
        "policy.privacy.p1":"Este sitio recoge algunos datos personales (p. ej., dirección IP) solo para estadísticas y seguridad. Sin datos sensibles ni marketing.",
        "policy.privacy.p2":"Los datos se almacenan de forma segura y no se ceden a terceros. Puedes solicitar su eliminación en andreacolucci@hotmail.it.",

        "policy.cookie.t":"Política de Cookies",
        "policy.cookie.p1":"Usamos solo cookies técnicas para el correcto funcionamiento. Puedes desactivarlas en el navegador, pero algunas funciones pueden limitarse.",
        "policy.cookie.p2":"Info: andreacolucci@hotmail.it.",

        "policy.terms.t":"Términos de Servicio",
        "policy.terms.p1":"Todo el contenido (vídeos, textos, imágenes) es © Andrea Colucci. Prohibida la reproducción sin permiso por escrito.",
        "policy.terms.p2":"El sitio se ofrece “tal cual”, sin garantías. No se asume responsabilidad por daños derivados de su uso."
      }
    });
  })();
})();
</script>
<!-- FINE PARTE 5 / 5 -->

